(window.agentWebpackJsonp=window.agentWebpackJsonp||[]).push([[18],{523:function(t,e,n){"use strict";var a=n(1);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=n(143),a=a(n(203)),n=n(620),n=(0,o.connect)(function(t){return t})((0,a.default)(n.Launcher,"Launcher"));e.default=n},620:function(t,e,n){"use strict";var a=n(1);Object.defineProperty(e,"__esModule",{value:!0}),e.Launcher=void 0;var r=a(n(79)),i=a(n(80)),c=a(n(57)),s=a(n(58)),l=a(n(204)),u=a(n(141)),o=a(n(142)),d=a(n(97)),w=a(n(23)),p=a(n(19)),f=n(27),h=n(15),m=n(78),v=n(11),E=n(17),b=n(98),_=n(206),g=a(n(99)),y=a(n(14)),C=n(68),S=n(621);function A(n){var a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,d.default)(n);return e=a?(t=(0,d.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,o.default)(this,e)}}var T="".concat(h.M24DL84,"/cta_help.png"),W="".concat(h.M24DL84,"/cta_chat.png"),K="".concat(h.M24DL84,"/cta_icon.png"),I="".concat(h.M24DL84,"/cta_help_b.png"),M="".concat(h.M24DL84,"/cta_chat_b.png"),D="".concat(h.M24DL84,"/cta_icon_b.png"),k=null,h=function(t){(0,u.default)(o,t);var e,n,a=A(o);function o(t){return(0,c.default)(this,o),(t=a.call(this,t)).handleToggle=t.handleToggle.bind((0,l.default)(t)),t.handleTouchMove=t.handleTouchMove.bind((0,l.default)(t)),t.addAnimatedImageSupport=t.addAnimatedImageSupport.bind((0,l.default)(t)),t.getAnimatedImageClass=t.getAnimatedImageClass.bind((0,l.default)(t)),t.state={dimensions:{height:""}},t}return(0,s.default)(o,[{key:"isPNG",value:function(t){return"png"===(("string"==typeof t?t.split(".").pop():null)||t)}},{key:"hasAPNGSupport",value:function(){return!(m.DEVICE__EDGE||m.DEVICE__IE11||navigator.userAgent.match(/MSIE ([0-9]+)\./)&&10<=parseInt(RegExp.$1)||navigator.userAgent.match(/Chrome\/([0-9]+)\./)&&parseInt(RegExp.$1)<=58)}},{key:"addAnimatedImageSupport",value:function(){(0,y.default.searchInsideShadowRoot)(".aivochat-animated-image")[0].forEach(function(t){k.animateImage(t)})}},{key:"getAnimatedImageClass",value:function(t){var e=this.hasAPNGSupport()?"":"aivochat-animated-image";return e=this.isPNG(t||"")?e:""}},{key:"handleToggle",value:(n=(0,i.default)(r.default.mark(function t(e){var n,a,o,i,c,s;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),i=this.props,n=i.dispatch,a=i.agentConfig,o=i.agentMessages,c=a.chatWindow.launcher.position||"right_bottom",i="right"===c.split("_")[0]?"right":"left",!a._windowOpened&&(0,E.pressEnterSpaceOrClick)(e))return t.next=7,(0,_.importAgentAppChunk)();t.next=16;break;case 7:return s=t.sent,a.chatWindow.staticPosition||g.default.dragWindow(i),t.next=11,n((0,f.setAppConfig)({AgentApp:s}));case 11:(s=c=null,E.isSmallWindow)()&&null!==a.ctaMobile?(c=a.ctaMobile.ctaType,s=!!a.ctaMobile.complements):(0,E.isSmallWindow)()||null===a.ctaWeb||(c=a.ctaWeb.ctaType,s=!!a.ctaWeb.complements),(0,E.interactionWithUser)(o)?window[v.KEY__SDK]._onOpenWindow&&window[v.KEY__SDK]._onOpenWindow():(s=[{action:"event_id",param:a.app.id},{action:"event_type",param:"firstInteraction-chat"},{action:"cta_type",param:c},{action:"activated_button",param:s},{action:"event",param:"open_cta"}],(0,C.setEventAnalytics)(a.user.id,a.app.id,window.navigator.userAgent,s),window[v.KEY__SDK]._onFirstInteraction&&window[v.KEY__SDK]._onFirstInteraction("open_cta")),n((0,f.openWindow)());case 16:(0,E.pressEscapeOrTab)(e)&&e.target.blur();case 17:case"end":return t.stop()}},t,this)})),function(t){return n.apply(this,arguments)})},{key:"handleTouchMove",value:function(t){var e,n,a,o,i=y.default.searchInsideShadowRoot(".agent-launcher")[0],c=i.classList.value;(0,E.isSmallWindow)()&&-1!==(-1!==c.indexOf("aivochat-launcher")||-1!==c.indexOf("agent-launcher")||c.indexOf("custom-html-css"))&&(t.preventDefault(),a=window.scrollY||window.pageYOffset,o=window.scrollX||window.pageXOffset,e=i.offsetWidth||i.clientWidth,n=i.offsetHeight||i.clientHeight,c=t.changedTouches[0].pageX-e/2,t=t.changedTouches[0].pageY-n/2,a=window.outerHeight-t-n+a,o=c-o,i.style.top="auto",i.style.right="auto",(a=a>window.outerHeight-n?window.outerHeight-n:a)<0&&(a=0),(o=o>window.outerWidth-e?window.outerWidth-e:o)<0&&(o=0),i.style.bottom="".concat(a,"px"),i.style.left="".concat(o,"px"))}},{key:"importAPNG",value:(e=(0,i.default)(r.default.mark(function t(){return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,_.importAPNGChunk)();case 2:k=t.sent,this.addAnimatedImageSupport();case 4:case"end":return t.stop()}},t,this)})),function(){return e.apply(this,arguments)})},{key:"componentDidMount",value:function(){var e=this,n=y.default.searchInsideShadowRoot(".agent-launcher")[0],t=this.props,a=t.dispatch,o=t.agentConfig,i=t.agentMessages,c=o.chatWindow.launcher,s=c.type,t=c.mobile,c=y.default.searchInsideShadowRoot,r=null;(0,E.isSmallWindow)()&&null!==o.ctaMobile?r=o.ctaMobile.ctaType:(0,E.isSmallWindow)()||null===o.ctaWeb||(r=o.ctaWeb.ctaType),n&&(n.addEventListener?n.addEventListener("touchmove",this.handleTouchMove):n.attachEvent("touchmove",this.handleTouchMove),this.hasAPNGSupport()||this.importAPNG()),(4===s&&!(0,E.isSmallWindow)()||(0,E.isSmallWindow)()&&4===t.type)&&setTimeout(function(){var t=(0,E.getHeightParentOrChild)(n);e.setState({dimensions:{height:t+30}})},1e3),c(".agent-launcher").length&&c(".agent-launcher")[0].addEventListener("click",function(){var t;(0,E.interactionWithUser)(i)?window[v.KEY__SDK]._onOpenWindow&&window[v.KEY__SDK]._onOpenWindow():(t=[{action:"event_id",param:o.app.id},{action:"event_type",param:"firstInteraction-chat"},{action:"cta_type",param:r},{action:"event",param:"open_cta"}],(0,C.setEventAnalytics)(o.user.id,o.app.id,window.navigator.userAgent,t),window[v.KEY__SDK]._onFirstInteraction&&window[v.KEY__SDK]._onFirstInteraction("open_cta")),a((0,f.openWindow)())});c=window.document.querySelector(".agent-launcher");c&&c.addEventListener("click",function(){var t;(0,E.interactionWithUser)(i)?window[v.KEY__SDK]._onOpenWindow&&window[v.KEY__SDK]._onOpenWindow():(t=[{action:"event_id",param:o.app.id},{action:"event_type",param:"firstInteraction-chat"},{action:"cta_type",param:r},{action:"event",param:"open_cta"}],(0,C.setEventAnalytics)(o.user.id,o.app.id,window.navigator.userAgent,t),window[v.KEY__SDK]._onFirstInteraction&&window[v.KEY__SDK]._onFirstInteraction("open_cta")),a((0,f.openWindow)())})}},{key:"getLauncher",value:function(){var t=this.props.agentConfig.chatWindow.launcher,e=t;return(0,E.isSmallWindow)()&&t.mobile?e=t.mobile:!(0,E.isSmallWindow)()&&t.web&&(e=t.web),e.enabled=t.enabled,e}},{key:"render",value:function(){var a=this,s=this,t=this.props,r=t.agentConfig,l=t.agentMessages,e=r.chatWindow,o=e.launcher,u=e.staticPosition,d=e.colors,n=r._windowOpened,t=r.__launcherHidden,e=r.chatWindow.launcher.enabled,p=!n&&e&&!t,i=y.default.searchInsideShadowRoot,c=y.default.removeElement,f=y.default.createElement,h=y.default.getTranslations(),m=function(t,e,n){n=(0,E.onLauncherLoad)(t,e,n);a.setState({dimensions:{height:n}})},_=function(t){var e=s.getAnimatedImageClass(o.image),n=s.getLauncher();switch(t||n.type){case 2:case 3:return w.default.createElement("img",{crossOrigin:"anonymous",className:e,src:n.image,alt:h.openChat});case 4:return c("#custom_launcher_styles"),n.css&&i()[0].appendChild(f("style",{nonce:v.KEY__NONCE,id:"custom_launcher_styles",innerHTML:"".concat(n.css)})),w.default.createElement("div",{dangerouslySetInnerHTML:{__html:n.html.replace(/(\\")/gm,'"')}});default:return g(t||n.type)}},g=function(t){var e="",n=(0,b.contrast)(d[0]),a=r.ctaWeb||null,o=r.ctaWeb?r.ctaMobile:null;switch(t){case 1:e=n?T:I;break;case 5:e=n?W:M;break;case 6:e=n?K:D}return a.showNotification&&!(0,E.isSmallWindow)()||o.showNotification&&(0,E.isSmallWindow)()?w.default.createElement("div",{className:"aivochat-launcher__notification"},w.default.createElement("div",{className:"aivochat-launcher__notification-icon"},w.default.createElement("p",null,"1")),w.default.createElement("div",{className:"aivochat-launcher__notification-image",style:{backgroundImage:"url(".concat(e,")")}})):w.default.createElement("div",{className:"aivochat-launcher__notification-image",style:{backgroundImage:"url(".concat(e,")")}})};return w.default.createElement("div",null,function(){var t,i=s.getLauncher(),e=r.chatWindow.launcher.position;(0,E.isSmallWindow)()&&r.ctaMobile?t=r.ctaMobile:!(0,E.isSmallWindow)()&&r.ctaWeb&&(t=r.ctaWeb);function n(t){var e=(0,E.getPositionClass)(i.position||"right_bottom"),n=u?v.KEY__STATIC_POSITION:"",a="".concat(p?v.KEY__ELEMENT_SHOW:v.KEY__ELEMENT_HIDE),o="".concat(v.KEY__LAUNCHER," ").concat(e," ").concat(n," ").concat(a);switch(t||i.type){case 1:case 5:case 6:return"".concat(o," custom-background");case 2:return"".concat(o," ").concat(v.KEY__LAUNCHER_TYPE_WITH_IMAGE," custom-background");case 3:return"".concat(o," ").concat(v.KEY__LAUNCHER_TYPE_ONLY_IMAGE);case 4:return"".concat(e," ").concat(a," ").concat(v.KEY__LAUNCHER_TYPE_CUSTOM)}}var a=e;if(!i.enabled)return null;(0,E.isSmallWindow)()&&(a=r.chatWindow.launcher.mobile.position);var o=s.state.dimensions,c=s.props.dispatch;switch(i.type){case 3:return w.default.createElement("div",null,w.default.createElement("div",{role:"button","aria-label":h.openChat,tabIndex:"0",onKeyDown:s.handleToggle,id:"".concat(v.KEY__LAUNCHER),className:"".concat(n()),onClick:s.handleToggle,onLoad:function(t){return m(t.target.height,i.type,a)}},_()),w.default.createElement(S.CTAButtons,{dispatch:c,dimensions:o,colors:d,classPosition:a,ctaButtonsData:t,agentConfig:r,agentMessages:l}));case 4:return w.default.createElement("div",null,w.default.createElement("div",{role:"button","aria-label":h.openChat,tabIndex:"0",onKeyDown:s.handleToggle,id:"".concat(v.KEY__LAUNCHER),className:"".concat(n()),onLoad:function(t){return m(t.target.height,i.type,a)}},_()),w.default.createElement(S.CTAButtons,{dispatch:c,dimensions:o,colors:d,classPosition:a,ctaButtonsData:t,agentConfig:r,agentMessages:l}));default:return w.default.createElement("div",null,w.default.createElement("div",{role:"button","aria-label":h.openChat,tabIndex:"0",onKeyDown:s.handleToggle,id:v.KEY__LAUNCHER,className:n(),onClick:s.handleToggle},_()),w.default.createElement(S.CTAButtons,{dispatch:c,dimensions:{height:(0,E.onLauncherLoad)(v.KEY__HEIGHT_CTA_TYPE_GIF,i.type,a)},colors:d,classPosition:a,ctaButtonsData:t,agentConfig:r,agentMessages:l}))}}())}}]),o}(w.default.Component);(e.Launcher=h).propTypes={agentConfig:p.default.object,dispatch:p.default.func,agentMessages:p.default.array}},621:function(t,e,n){"use strict";var a=n(1);Object.defineProperty(e,"__esModule",{value:!0}),e.CTAButtons=void 0;var o=a(n(57)),i=a(n(58)),c=a(n(204)),s=a(n(141)),r=a(n(142)),l=a(n(97)),d=a(n(9)),f=a(n(23)),p=n(27),u=a(n(19)),h=a(n(14)),m=n(17),_=n(11),g=n(68);function w(n){var a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,l.default)(n);return e=a?(t=(0,l.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,r.default)(this,e)}}n=function(t){(0,s.default)(n,t);var e=w(n);function n(t){var u;return(0,o.default)(this,n),u=e.call(this,t),(0,d.default)((0,c.default)(u),"handleCloseCTAButtons",function(t,e,n,a){(0,m.pressEnterSpaceOrClick)(t)&&(t.preventDefault(),a=[{action:"event_id",param:n.id},{action:"event_type",param:"close_cta_buttons"},{action:"cta_type",param:n.ctaType},{action:"activated_buttons",param:null!==a},{action:"event",param:"close_cta_buttons"}],(0,g.setEventAnalytics)(e.user.id,e.app.id,window.navigator.userAgent,a),window[_.KEY__SDK]._onCloseCtaButtons&&window[_.KEY__SDK]._onCloseCtaButtons(),u.props.dispatch((0,p.setConfig)({_showCTAButtons:!1})),u.setState({closedComponent:!0}))}),(0,d.default)((0,c.default)(u),"calculateMargin",function(t){switch(t){case"right_bottom":case"center_bottom":case"left_bottom":return"bottom";default:return"top"}}),(0,d.default)((0,c.default)(u),"handleSendButtonCTA",function(t,e,n,a,o,i,c){var s=n.app,r=h.default.getUsers(),l=u.props.agentMessages,r=r[0],c=null!==c;(0,m.pressEnterSpaceOrClick)(t)&&(t.preventDefault(),a=[{action:"event_id",param:i.id},{action:"event_type",param:"firstInteraction-chat"},{action:"cta_type",param:i.ctaType},{action:"activated_button",param:c},{action:"event",param:"click_send_button"},{action:"event_value",param:o},{action:"group",param:a}],(0,m.interactionWithUser)(l)||((0,g.setEventAnalytics)(n.user.id,n.app.id,window.navigator.userAgent,a),window[_.KEY__SDK]._onFirstInteraction&&window[_.KEY__SDK]._onFirstInteraction("click_send_button")),u.props.dispatch((0,p.setConfig)({_showCTAButtons:!1})),u.setState({closedComponent:!0}),e((0,p.openWindow)()),e((0,p.sendMessage)(o,r,s.id)))}),(0,d.default)((0,c.default)(u),"handleSendMessageCTA",function(t,e,n,a,o){var i=u.props.agentMessages,o=null!==o;(0,m.pressEnterSpaceOrClick)(t)&&(t.preventDefault(),a=[{action:"event_id",param:a.id},{action:"event_type",param:"firstInteraction-chat"},{action:"cta_type",param:a.ctaType},{action:"activated_button",param:o},{action:"event",param:"click_send_message"},{action:"group",param:a.message}],(0,m.interactionWithUser)(i)||((0,g.setEventAnalytics)(n.user.id,n.app.id,window.navigator.userAgent,a),window[_.KEY__SDK]._onFirstInteraction&&window[_.KEY__SDK]._onFirstInteraction("click_send_message")),u.setState({closedComponent:!0}),u.props.dispatch((0,p.setConfig)({_showCTAButtons:!1})),e((0,p.openWindow)()))}),u.state={closedComponent:!1},u}return(0,i.default)(n,[{key:"render",value:function(){var n=this,t=this.props,a=t.dispatch,e=t.dimensions,o=t.colors,i=t.classPosition,c=t.ctaButtonsData,s=t.agentConfig,r=h.default.getTranslations(),l=c.complements,u=s,d=this.state.closedComponent,p=u._showCTAButtons,t=this.calculateMargin(i),s="top"===t?e.height:0,e="bottom"===t?e.height:0;return d&&!p||null===c.message&&null===l?null:f.default.createElement("div",{className:"cta-buttons__notification-container\n            cta-buttons__notification__".concat(i),style:{marginTop:"".concat(s,"px"),marginBottom:"".concat(e,"px")}},null!==c.message&&(0,m.isSmallWindow)()||!(0,m.isSmallWindow)()?f.default.createElement("div",{className:"cta-buttons__notification-container-close"},f.default.createElement("i",{role:"button","aria-label":r.closeButton,tabIndex:"1",style:{background:o[0]},className:"material-icons",onClick:function(t){return n.handleCloseCTAButtons(t,u,c,l)},onKeyDown:function(t){return n.handleCloseCTAButtons(t,u,c,l)}},"close")):null,null!==c.message?f.default.createElement("div",{role:"button","aria-label":c.message,tabIndex:"1",onClick:function(t){return n.handleSendMessageCTA(t,a,u,c,l)},onKeyDown:function(t){return n.handleSendMessageCTA(t,a,u,c,l)},className:"cta-buttons__notification-container-message"},f.default.createElement("h4",null,c.message)):null,null===l||(0,m.isSmallWindow)()?null:f.default.createElement("div",{className:"cta-buttons__notification-container-buttons"},l.map(function(e){return f.default.createElement("div",{className:"cta-buttons__notification-container-buttons-element",key:e.name},f.default.createElement("button",{tabIndex:"1",style:{background:o[0]},onClick:function(t){return n.handleSendButtonCTA(t,a,u,e.name,e.intention,c,l)},onKeyDown:function(t){return n.handleSendButtonCTA(t,a,u,e.name,e.intention,c,l)}},e.name))})))}}]),n}(f.default.Component);(e.CTAButtons=n).propTypes={dispatch:u.default.func,colors:u.default.array,classPosition:u.default.string,ctaButtonsData:u.default.object,dimensions:u.default.object,agentConfig:u.default.object,agentMessages:u.default.array}}}]);