window.SearchSpringInit = function() {
// springboard generated variables
var modules = {};
modules.enabled = true;

var self = this;
var reset;
var mainBp = 1159;

var specialized = {
	page          : 'search',
	title         : 'Search Results',
	view          : false,
	cTrigger      : '.Collapsible__trigger',
	cContainer    : '.Collapsible__contentOuter',
	cClass        : 'is-open',
	imgReplace    : '?hybris-large',
	imgSize       : '?$hybris-large$',
	imgSize2      : '?$hybris-pdp-hero$',
	group         : 'consumer',
	price         : 'ss_price',
	touch         : ('ontouchstart' in window || window.DocumentTouch && document instanceof DocumentTouch),
	mobile        : isMobile(mainBp),
	sidebar       : isMobile(mainBp) ? false : true,
	filterAnimate : function() {
		// Initiate SVG animation for burger icon
		var animatedMenuIcon = document.getElementById('burger-with-animation');
		var animations = animatedMenuIcon.querySelectorAll('animate');

		angular.forEach(animations, function(animation) {
			if (!animation.beginElement) { return } // disable animation if browser does not support it
			animation.beginElement();
		});
	},
	sideToggle    : function() {
		this.sidebar = this.sidebar ? false : true;
		this.filterAnimate();

		if (isMobile(mainBp)) {
			var bodyTag = angular.element(document.querySelector('body'));
			var bodyClasses = 'global-backdrop-visible';
			if (bodyTag.hasClass(bodyClasses)) {
				bodyTag.removeClass(bodyClasses);
			} else {
				bodyTag.addClass(bodyClasses);
			}
		}
	}
}

var spellCondition = true; 

// -- START -- REGION CONFIG

var specializedCode = 'us';
var specializedLang = (self.context.language && typeof self.context.language == 'string') ? self.context.language : 'en';

// Default region settings for template display
// $#,###.##
specialized.region = {
	siteId   : 'c1kac2',
	location : 'United States',
	code     : specializedCode,
	code2    : 'USD',
	lang     : specializedLang,
	domain   : window.location.hostname + '/' + specializedCode + '/' + specializedLang,
	contact  : 'Specialized Bicycle Components, Inc.<br />15130 Concord Circle<br />Morgan Hill, CA 95037<br />USA',
	prefix   : '$',
	decimal  : 2,
	thousand : ',',
	cent     : '.',
	split    : '.00',
	suffix   : ''
};

// Germanic default
var isGermanic = false;
var isBenelux = false;
var isIberian = false;
var isMultiRegion = false;

if (self.context.region && typeof self.context.region == 'string' && self.context.region != 'us') {
	//Disable spell correction on all foreign sites 
	spellCondition = false;
	
	specializedCode = self.context.region;
	
	
	// Check if site is Germanic
	isGermanic = (specializedCode == 'de' || specializedCode == 'lu' || specializedCode == 'at') ? true : false;
	isSwiss = (specializedCode == 'ch' || specializedCode == 'li') ? true : false;
	isBenelux = (specializedCode == 'be' || specializedCode == 'nl') ? true : false;
	isIberian = (specializedCode == 'es' || specializedCode == 'pt') ? true : false;
	isMultiRegion = isGermanic || isSwiss || isBenelux || isIberian;
	

	// Updated non-specific region settings
	specialized.region.code = specializedCode;
	specialized.region.lang = specializedLang;
	specialized.region.domain = window.location.hostname + '/' + specializedCode + '/' + specializedLang;


	// Update region specific settings
	if (specializedCode == 'au') {
		// Basic region information
		specialized.region.siteId = 'zkxft9';
		specialized.region.location = 'Australia';
		specialized.region.code2 = 'AUD';

		// Contact page information
		specialized.region.contact = 'Specialized Australia<br />299 Williamstown Road<br />Port Melbourne, Victoria 3207<br />Australia';

		// Price changes - Example: $#,###.##
		// No changes, same as USD
	} else if (specializedCode == 'nz') {
		// Basic region information
		specialized.region.siteId = '71n5xk';
		specialized.region.location = 'New Zealand';
		specialized.region.code2 = 'NZD';

		// Contact page information
		specialized.region.contact = 'Specialized New Zealand<br />22 Clarence St South<br />Addington<br />Christchurch<br />New Zealand, 8024';

		// Price changes - Example: $#,###.##
		// No changes, same as USD
	} else if (specializedCode == 'br') {
		// Basic region information
		specialized.region.location = 'Brasil';
		specialized.region.code2 = 'BR';
		
		// CA Language updates
		if (specialized.region.lang == 'pt') {
			// Basic region information
			specialized.region.siteId = 'l2m2kl';

			// Contact page information
			specialized.region.contact = 'Specialized Brasil Comercio de Bicicletas Ltda.<br />Av. Rodovia Governador Mario Covas, 4462<br />Planalto de Carapina<br />Serra - ES - Espírito Santo - 29162-702<br />CNPJ: 11.838.642/0001-80';

			// Price changes - Example: R$9.300,00
			specialized.region.prefix = 'R$';
			specialized.region.thousand = '.';
			specialized.region.cent = ',';
			specialized.region.split = ',00'; 
			
		} else {
			// Basic region information
			specialized.region.siteId = 'd2wlvm';

			// Price changes - Example: R$9,300.00
			specialized.region.prefix = 'R$';
			specialized.region.contact = 'Specialized Brasil Comercio de Bicicletas Ltda.<br />Av. Rodovia Governador Mario Covas, 4462<br />Planalto de Carapina<br />Serra - ES - Espírito Santo - 29162-702<br />CNPJ: 11.838.642/0001-80';
		}
	} else if (specializedCode == 'it') {
		// Basic region information
		specialized.region.location = 'Italy';
		specialized.region.code2 = 'IT';
		
		// CA Language updates
		if (specialized.region.lang == 'it') {
			// Basic region information
			specialized.region.siteId = 'c79fdr';

			// Price changes - Example: #.###,## €
			specialized.region.prefix = '';
			specialized.region.thousand = '.';
			specialized.region.cent = ',';
			specialized.region.split = ',00';
			specialized.region.suffix = ' \u20AC';
		} else {
			// Basic region information
			specialized.region.siteId = 'ylt09d';

			// Price changes - Example: #.###,## €
			specialized.region.prefix = '\u20AC';
		}
	}  else if (isIberian) {
		// Basic region information
		specialized.region.location = 'España';
		specialized.region.code2 = 'ES';
		
		// CA Language updates
		if (specialized.region.lang == 'es') {
			// Basic region information
			specialized.region.siteId = '0f2k79';

			// Price changes - Example: #.###,## €
			specialized.region.prefix = '';
			specialized.region.thousand = '.';
			specialized.region.cent = ',';
			specialized.region.split = ',00';
			specialized.region.suffix = ' \u20AC';
		} else if (specialized.region.lang == 'pt') {
			// Basic region information
			specialized.region.siteId = 'h66grz';

			// Price changes - Example: #.###,## €
			specialized.region.prefix = '';
			specialized.region.thousand = '.';
			specialized.region.cent = ',';
			specialized.region.split = ',00';
			specialized.region.suffix = ' \u20AC';
			
			// specialized.region.contact = 'Specialized Brasil Comercio de Bicicletas Ltda.<br />Av. Rodovia Governador Mario Covas, 4462<br />Planalto de Carapina<br />Serra - ES - Espírito Santo - 29162-702<br />CNPJ: 11.838.642/0001-80';
		} else {
			// Basic region information
			specialized.region.siteId = 'kl6rn1';

			// Price changes - Example: #.###,## €
			specialized.region.prefix = '\u20AC';
		}
	} else if (specializedCode == 'ca') {
		// Basic region information
		specialized.region.location = 'Canada';
		specialized.region.code2 = 'CAD';

		// Contact page information
		specialized.region.contact = 'Specialized Canada Inc.<br />20975 rue Daoust<br />Ste-Anne-de-Bellevue, QC H9X 0A3<br />Canada';
		
		// CA Language updates
		if (specialized.region.lang == 'fr') {
			// Basic region information
			specialized.region.siteId = '5vvgx2';

			// Price changes - Example: # ###,## $
			specialized.region.prefix = '';
			specialized.region.thousand = ' ';
			specialized.region.cent = ',';
			specialized.region.split = ',00';
			specialized.region.suffix = ' $';
		} else {
			// Basic region information
			specialized.region.siteId = '3i6nt5';

			// Price changes - Example: $#,###.##
			// No changes, same as USD
		}
	} else if (isGermanic) {
		// Basic region information
		specialized.region.location = 'Deutschland';
		specialized.region.code2 = 'EUR';
		
		// DE Language updates
		if (specialized.region.lang == 'de') {
			// Basic region information
			specialized.region.siteId = 'zum3o1';

			// Contact page information
			specialized.region.contact = 'Specialized Germany GmbH<br />Hauptstr. 4<br />D-83607 HOLZKIRCHEN-F\u00D6CHING';

			// Price changes - Example: #.###,## €
			specialized.region.prefix = '';
			specialized.region.thousand = '.';
			specialized.region.cent = ',';
			specialized.region.split = ',00';
			specialized.region.suffix = ' \u20AC';
		} else if (specialized.region.lang == 'fr') {
			// Basic region information
			specialized.region.siteId = 'vhtfqf';
			

			// Contact page information
			specialized.region.contact = 'Specialized Germany GmbH<br />Hauptstra\u00DFe 4<br />83607 Holzkirchen<br />Germany';

			// Price changes - Example: €#.###,##
			specialized.region.prefix = '\u20AC';
			specialized.region.thousand = '.';
			specialized.region.cent = ',';
			specialized.region.split = ',00';
		} else {
			// Basic region information
			specialized.region.siteId = 'cgcsbe';

			// Contact page information
			specialized.region.contact = 'Specialized Germany GmbH<br />Hauptstra\u00DFe 4<br />83607 Holzkirchen<br />Germany';

			// Price changes - Example: €#,###.##
			specialized.region.prefix = '\u20AC';
		}
	} else if (isSwiss) {
		// Basic region information
		specialized.region.location = 'Switzerland';
		specialized.region.code2 = ' CHF';
		
		// DE Language updates
		if (specialized.region.lang == 'de') {
			// Basic region information
			specialized.region.siteId = 'rkm4hd';
			specialized.region.location = 'Schweiz';


			// Contact page information
			specialized.region.contact = 'Specialized Europe GmbH<br />Rothusstrasse 24<br />CH-6331 Hünenberg';

			// Price changes - Example: #.###,## €
			specialized.region.prefix = '';
			specialized.region.thousand = ' ';
			specialized.region.cent = ',';
			specialized.region.split = ',00';
			specialized.region.suffix = ' CHF';
		} else if (specialized.region.lang == 'fr') {
			// Basic region information
			specialized.region.siteId = '3fpvwm';
			specialized.region.location = 'La Suisse';

			// Contact page information
			specialized.region.contact = 'Specialized Europe GmbH<br />Rothusstrasse 24<br />CH-6331 Hünenberg';

			// Price changes - Example: €#.###,##
			specialized.region.prefix = '';
			specialized.region.thousand = ' ';
			specialized.region.cent = ',';
			specialized.region.split = ',00';
			specialized.region.suffix = ' CHF';
		} else {
			// Basic region information
			specialized.region.siteId = 'xsx1f8';

			// Contact page information
			specialized.region.contact = 'Specialized Europe GmbH<br />Rothusstrasse 24<br />CH-6331 Hünenberg';

			// Price changes - Example: €#,###.##
			specialized.region.prefix = '';
			specialized.region.thousand = ' ';
			specialized.region.cent = ',';
			specialized.region.split = ',00';
			specialized.region.suffix = ' CHF';
		}
	} else if (isBenelux) {
		// Basic region information
		specialized.region.location = 'Benelux';
		specialized.region.code2 = 'EUR';
		
		// DE Language updates
		if (specialized.region.lang == 'nl') {
			// Basic region information
			specialized.region.siteId = '2hb317';

			// Contact page information
			specialized.region.contact = 'Specialized Europe BV<br />Utrechtseweg 310, Building B01<br />6812 AR Arnhem<br />Holland';

			// Price changes - Example: #.###,## €
			specialized.region.prefix = '';
			specialized.region.thousand = '.';
			specialized.region.cent = ',';
			specialized.region.split = ',00';
			specialized.region.suffix = ' \u20AC';
		} else if (specialized.region.lang == 'fr') {
			// Basic region information
			specialized.region.siteId = '2509xg';

			// Contact page information
			specialized.region.contact = 'Specialized Europe BV<br />Utrechtseweg 310, Building B01<br />6812 AR Arnhem<br />Holland';

			// Price changes - Example: €#.###,##
			specialized.region.prefix = '';
			specialized.region.thousand = '.';
			specialized.region.cent = ',';
			specialized.region.split = ',00';
			specialized.region.suffix = ' \u20AC';
		} else {
			// Basic region information
			specialized.region.siteId = '8jqv0z';

			// Contact page information
			specialized.region.contact = 'Specialized Europe BV<br />Utrechtseweg 310, Building B01<br />6812 AR Arnhem<br />Holland';

			// Price changes - Example: €#,###.##
			specialized.region.prefix = '\u20AC';
		}
	} else if (specializedCode == 'fr') {
		// Basic region information
		specialized.region.location = 'French';
		specialized.region.code2 = 'FR';
		
		// CA Language updates
		if (specialized.region.lang == 'fr') {
			// Basic region information
			specialized.region.siteId = 's6n0zd';

			// Contact page information
			specialized.region.contact = false;

			// Price changes - Example: €#.###,##
			specialized.region.prefix = '\u20AC';
			specialized.region.thousand = '.';
			specialized.region.cent = ',';
			specialized.region.split = ',00';
		} else {
			// Basic region information
			specialized.region.siteId = 'pr7637';

			// Price changes - Example: €#,###.##
			specialized.region.prefix = '\u20AC';
		}
	} else if (specializedCode == 'gb') {
		// Basic region information
		specialized.region.siteId = 'uyx5rv';
		specialized.region.location = 'United Kingdom';
		specialized.region.code2 = 'GBP';

		// Contact page information
		specialized.region.contact = false;

		// Price changes - Example: £#,###.00
		specialized.region.prefix = '\u00A3';
	} else if (specializedCode == 'sg') {
		// Basic region information
		specialized.region.siteId = 'lvh31p';
		specialized.region.location = 'Singapore';
		specialized.region.code2 = 'SGD';

		// Contact page information
		specialized.region.contact = 'Specialized Bicycle Components<br />Malaysia Sdn Bhd<br />T1, Common Ground TTDI, Level 11<br />Menara KEN TTDI, 37<br />Jalan Burhanuddin Helmi<br />Taman Tun Dr. Ismail<br />60000 Kuala Lumpur';

		// Price changes - Example: S$#,###.##
		specialized.region.prefix = 'S$';
	}

	// Set the correct site id to change data
	SearchSpring.Catalog.site.id = specialized.region.siteId;
}

// -- END -- REGION CONFIG

// -- START -- LANGUAGE CONFIG

// Codes: en (English), fr (French), de (German), pt (Portuguese), es (Spanish), nl (Dutch), it (Italian)

var lang = {
	en : {
		facets     : {
			apply : 'Apply',
			clear : 'Clear',
			show  : 'Show Filters',
			less  : 'Show Less',
			more  : 'Show More'
		},
		summary    : {
			clear   : 'Clear All',
			current : 'Current Filters',
			filters : 'Filters'
		},
		compare    : {
			compare  : 'Compare',
			added    : 'Added',
			adding   : 'Adding...',
			error    : 'Could not add product to compare',
			selected : 'of 4 item selected',
			reached  : 'Only four items can be added to the compare preview at a time. If you wish to compare more, please remove an item from your preview before processing.',
			remove   : 'Remove',
			removed  : 'Product removed from comparison'
		},
		ac         : {
			suggestions : 'Top Suggestions',
			noResults   : function(q) {
				return 'No results found for "' + q + '". Please try another search.';
			},
			total       : function(n, q) {
				var message = (n === 1) ? 'See 1 filtered result' : ('See ' + n + ' filtered results');
				return message + (' for "' + q + '"');
			}
		},
		results    : {
			loading : 'Loading...',
			showing : function(q, oq, url) {
				return 'Showing results for "<strong>' + q.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;") + '</strong>". Search instead for "<a class="ss-oq-link" href="' + url + '">' + oq.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;") + '</a>".';
			},
			query   : function(q) {
				return q ? ('Search Results for "' + q.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;") + '"') : ('Search Results');
			},
			total   : function(n) {
				return n ? ('Products (' + n + ')') : ('Products');
			},
			none    : function(q) {
				return 'We didn\'t find an exact match for "<strong>' + q.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;") + '</strong>", but here are some similar products...';
			}
		},
		sort       : {
			sort : 'Sort',
			by   : 'Sort By'
		},
		pagination : {
			all      : 'View All',
			paginate : 'Show Paginated',
			total    : 'Total Products'
		},
		noResults  : {
			query    : function(q) {
				return 'No Results Found for "' + q + '". Please try another search.';
			},
			dym      : function(q, url) {
				return 'Did you mean "<a href="' + url + '">' + q + '</a>"?';
			},
			suggest  : 'Suggestions',
			suggest1 : 'Check for misspellings',
			suggest2 : 'Remove possible redundant keywords (ie. "products")',
			suggest3 : 'Use other words to describe what you are searching for',
			address  : 'Address'
		},
		misc       : {
			show : 'Show Filters',
			hide : 'Hide Filters',
			back : function(url) {
				return 'Your love of filters is inspiring, but you need to <a href="' + url + '">GO BACK</a> and remove some of them to see your results.';
			}
		}
	},
	fr : {
		facets     : {
			apply : 'Appliquer',
			clear : 'Effacer',
			show  : 'Afficher les filtres',
			less  : 'Afficher moins',
			more  : 'Afficher plus'
		},
		summary    : {
			clear   : 'Tout effacer',
			current : 'Filtres actuels',
			filters : 'Filtres'
		},
		compare    : {
			compare  : 'Comparer',
			added    : 'Article ajout\u00E9',
			adding   : 'Ajout\u00E9...',
			error    : 'Impossible d\'ajouter le produit \u00E0 comparer',
			selected : 'sur 4 article(s) s\u00E9lectionn\u00E9(s)',
			reached  : 'Seulement 4 articles peuvent \u00EAtre ajout\u00E9s au comparateur \u00E0 la fois. Si vous souhaitez ajouter un article suppl\u00E9mentaire, veuillez en enlever un avant d\'en ajouter un autre.',
			remove   : 'Retirer',
			removed  : 'Article retir\u00E9'
		},
		ac         : {
			suggestions : 'Meilleures suggestions',
			noResults   : function(q) {
				return 'Aucun r\u00E9sultat rouv\u00E9 pour "' + q + '". Veuillez essayer une nouvelle recherche. ';
			},
			total       : function(n, q) {
				var message = (n === 1) ? 'Voir 1 r\u00E9sultat filtr\u00E9' : ('Voir ' + n + ' articles trouv\u00E9s');
				return message + (' pour "' + q + '"');
			}
		},
		results    : {
			loading : 'Chargement...',
			showing : function(q, oq, url) {
				return 'Affichage des r\u00E9sultats pour "<strong>' + q.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;") + '</strong>". Recherchez plut\u00F4t pour "<a class="ss-oq-link" href="' + url + '">' + oq.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;") + '</a>".';
			},
			query   : function(q) {
				return q ? ('R\u00E9sultats pour "' + q.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;") + '"') : ('R\u00E9sultats');
			},
			total   : function(n) {
				return n ? ('Articles (' + n + ')') : ('Articles');
			},
			none    : function(q) {
				return 'Nous n\'avons pas trouv\u00E9 de r\u00E9sultats pour le mot-cl\u00E9 "<strong>' + q.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;") + '</strong>", mais voici des r\u00E9sultats similaires...';
			}
		},
		sort       : {
			sort : 'Trier par',
			by   : 'Trier par'
		},
		pagination : {
			all      : 'Afficher tout',
			paginate : 'Afficher par ordre alphab\u00E9tique',
			total    : 'Tous les produits'
		},
		noResults  : {
			query    : function(q) {
				return 'Aucun r\u00E9sultat pour "' + q + '". Veuillez faire une nouvelle recherche.';
			},
			dym      : function(q, url) {
				return 'Voulez-vous dire "<a href="' + url + '">' + q + '</a>"?';
			},
			suggest  : 'Suggestions',
			suggest1 : 'Regardez pour des fautes',
			suggest2 : 'Supprimez les \u00E9ventuels mots-cl\u00E9s redondants (par exemple, "produits")',
			suggest3 : 'Veuillez utiliser d\'autres mots pour d\u00E9crire ce que vous cherchez',
			address  : 'Adresse'
		},
		misc       : {
			show : 'Afficher les filtres',
			hide : 'Masquer les filtres',
			back : function(url) {
				return 'Votre amour pour les filtres est inspirant. Ceci dit, veuillez <a href="' + url + '">retourner</a> et en enlever quelques uns pour obtenir vos r\u00E9sultats.';
			}
		}
	},
	de : {
		facets     : {
			apply : 'Anwenden',
			clear : 'L\u00F6schen',
			show  : 'Filter anzeigen',
			less  : 'Weniger anzeigen',
			more  : 'Mehr anzeigen'
		},
		summary    : {
			clear   : 'Alles l\u00F6schen',
			current : 'Aktuelle Filter',
			filters : 'Filter'
		},
		compare    : {
			compare  : 'Vergleichen',
			added    : 'Hinzugef\u00FCgt',
			adding   : 'Hinzuf\u00FCgen...',
			error    : 'Produkt konnte nicht zum Vergleich hinzugef\u00FCgt werden',
			selected : 'von 4 ausgew\u00E4hlten Artikeln',
			reached  : 'Es k\u00F6nnen nur vier Artikel zur Vergleichsvorschau hinzugef\u00FCgt werden. Wenn du weitere Artikel vergleichen m\u00F6chtest, entferne bitte einen Artikel aus deiner Vorschau, bevor du fortf\u00E4hrst.',
			remove   : 'Entfernen',
			removed  : 'Produkt aus dem Vergleich entfernt'
		},
		ac         : {
			suggestions : 'Vorschl\u00E4ge',
			noResults   : function(q) {
				return 'Keine Ergebnisse f\u00FCr "' + q + '" gefunden. Bitte \u00E4ndere deine Suche und versuche es erneut.';
			},
			total       : function(n, q) {
				var message = (n === 1) ? 'Wir haben 1 Ergbnis' : ('Wir haben ' + n + ' Ergebnisse');
				return message + (' f\u00FCr "' + q + '" gefunden');
			}
		},
		results    : {
			loading : 'L\u00E4dt...',
			showing : function(q, oq, url) {
				return 'Ergebnisse f\u00FCr "<strong>' + q.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;") + '</strong>". Suche stattdessen nach "<a class="ss-oq-link" href="' + url + '">' + oq.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;") + '</a>".';
			},
			query   : function(q) {
				return q ? ('Suchergebnisse f\u00FCr "' + q.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;") + '"') : ('Suchergebnisse');
			},
			total   : function(n) {
				return n ? ('Produkte (' + n + ')') : ('Produkte');
			},
			none    : function(q) {
				return 'Wir haben keine passenden Ergebnisse f\u00FCr "<strong>' + q.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;") + '</strong>" gefunden, aber diese Produkte k\u00F6nnten dir vielleicht auch gefallen...';
			}
		},
		sort       : {
			sort : 'Sortieren',
			by   : 'Sortieren nach'
		},
		pagination : {
			all      : 'Alle ansehen',
			paginate : 'Seitennummer anzeigen',
			total    : 'Alle Produkte'
		},
		noResults  : {
			query    : function(q) {
				return 'Keine Ergebnisse f\u00FCr "' + q + '". Bitte \u00E4ndere deine Suche und versuche es erneut.';
			},
			dym      : function(q, url) {
				return 'Meintest du "<a href="' + url + '">' + q + '</a>"?';
			},
			suggest  : 'Vorschl\u00E4ge',
			suggest1 : 'Bitte \u00FCberpr\u00FCfe, ob sich ein Tippfehler eingeschlichen hat',
			suggest2 : 'Bitte l\u00F6sche generische oder redundante Begriffe wie z.B. "Produkte"',
			suggest3 : 'Bitte suche nach anderen, sinngem\u00E4\u00DFen Begriffen',
			address  : 'Adresse'
		},
		misc       : {
			show : 'Filter anzeigen',
			hide : 'Filter verbergen',
			back : function(url) {
				return 'Du scheinst gerne unsere Filter zu nutzen, jedoch solltest du <a href="' + url + '">ZUR\u00DCCK gehen</a> und einige Filter entfernen.';
			}
		}
	},
	pt : {
		facets     : {
			apply : 'Aplicar',
			clear : 'Limpar',
			show  : 'Mostrar Filtros',
			less  : 'Mostrar Menos',
			more  : 'Mostrar Mais'
		},
		summary    : {
			clear   : 'Limpar Filtros',
			current : 'Filtros Atuais',
			filters : 'Filtros'
		},
		compare    : {
			compare  : 'Comparar',
			added    : 'Adicionado',
			adding   : 'Adicionando...',
			error    : 'N\u00E3o foi poss\u00EDvel adicionar produto para compara\u00E7\u00E3o',
			selected : 'de 4 item selecionado',
			reached  : 'Apenas quatro itens podem ser adicionados para compara\u00E7\u00E3o por vez. Se voc\u00EA deseja comparar outros itens, remova um deles de sua visualiza\u00E7\u00E3o antes de processar.',
			remove   : 'Remover',
			removed  : 'Produto removido da compara\u00E7\u00E3o'
		},
		ac         : {
			suggestions : 'Mais Sugeridos',
			noResults   : function(q) {
				return 'Nenhum resultado foi encontrado para "' + q + '". Por favor tente outra pesquisa.';
			},
			total       : function(n, q) {
				var message = (n === 1) ? 'Veja 1 resultado filtrado' : ('Veja ' + n + ' resultados filtrados');
				return message + (' para"' + q + '"');
			}
		},
		results    : {
			loading : 'Carregando...',
			showing : function(q, oq, url) {
				return 'Mostrando resultados para "<strong>' + q.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;") + '</strong>". Ao inv\u00E9s disso, pesquise por "<a class="ss-oq-link" href="' + url + '">' + oq.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;") + '</a>".';
			},
			query   : function(q) {
				return q ? ('Resultados da pesquisa para "' + q.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;") + '"') : ('Resultados da pesquisa');
			},
			total   : function(n) {
				return n ? ('Produtos (' + n + ')') : ('Produtos');
			},
			none    : function(q) {
				return 'N\u00E3o conseguimos encontrar uma busca exata para "<strong>' + q.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;") + '</strong>", mas aqui est\u00E3o alguns produtos similares...';
			}
		},
		sort       : {
			sort : 'Ordenar',
			by   : 'Ordenar Por'
		},
		pagination : {
			all      : 'Ver Todos',
			paginate : 'Mostrar Pagina\u00E7\u00E3o',
			total    : 'Todos os Produtos'
		},
		noResults  : {
			query    : function(q) {
				return 'Nenhum resultado foi encontrado para "' + q + '". Por favor, revise sua pesquisa.';
			},
			dym      : function(q, url) {
				return 'Voc\u00EA quis dizer "<a href="' + url + '">' + q + '</a>"?';
			},
			suggest  : 'Sugest\u00F5es',
			suggest1 : 'Favor Verificar Erro de Digita\u00E7\u00E3o',
			suggest2 : 'Remova poss\u00EDveis palavras redundantes como "produtos"',
			suggest3 : 'Use outra palavra para descrever o que est\u00E1 procurando',
			address  : 'Endere\u00E7o'
		},
		misc       : {
			show : 'Mostar Filtros',
			hide : 'Esconder Filtros',
			back : function(url) {
				return 'O seu amor pelos filtros \u00E9 inspirador, mas voc\u00EA precisar\u00E1 <a href="' + url + '">voltar</a> e remover alguns deles para ver os resultados da busca.';
			}
		}
	},
	es : {
		facets     : {
			apply : 'Aplicar',
			clear : 'Limpiar',
			show  : 'Mostrar Filtros',
			less  : 'Mostrar Menos',
			more  : 'Mostrar M\u00E1s'
		},
		summary    : {
			clear   : 'Limpiar Filtros',
			current : 'Filtros Actuales',
			filters : 'Filtros'
		},
		compare    : {
			compare  : 'Comparar',
			added    : 'A\u00F1adir',
			adding   : 'A\u00F1adiendo...',
			error    : 'No se ha podido a\u00F1adir el producto para comparar',
			selected : 'de 4 elementos selccionados',
			reached  : 'Solamente se pueden a\u00F1adir cuatro elementos a la vista previa de la comparaci\u00F3n a la vez. Si deseas comparar m\u00E1s, elimina un elemento de tu vista previa antes de procesarlo.',
			remove   : 'Eliminar',
			removed  : 'Producto eliminado de la comparaci\u00F3n'
		},
		ac         : {
			suggestions : 'Sugerencias',
			noResults   : function(q) {
				return 'No se han encontrado resultados para "' + q + '". Int\u00E9ntalo de nuevo.';
			},
			total       : function(n, q) {
				var message = (n === 1) ? 'Ver 1 resultado filtrado' : ('Ver ' + n + ' resultados filtrados"');
				return message + (' de "' + q + '"');
			}
		},
		results    : {
			loading : 'Cargando...',
			showing : function(q, oq, url) {
				return 'Mostrando resultados para "<strong>' + q.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;") + '</strong>". En su lugar, busca por "<a class="ss-oq-link" href="' + url + '">' + oq.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;") + '</a>".';
			},
			query   : function(q) {
				return q ? ('Resultados de b\u00FAsqueda para "' + q.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;") + '"') : ('Resultados de b\u00FAsqueda');
			},
			total   : function(n) {
				return n ? ('Productos (' + n + ')') : ('Productos');
			},
			none    : function(q) {
				return 'No hemos encontrado una coincidencia exacta para "<strong>' + q.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;") + '</strong>", pero te mostramos algunos productos similares...';
			}
		},
		sort       : {
			sort : 'Ordenar',
			by   : 'Ordenar por'
		},
		pagination : {
			all      : 'Ver Todos',
			paginate : 'Mostrar Paginaci\u00F3n',
			total    : 'Total Productos'
		},
		noResults  : {
			query    : function(q) {
				return 'No se han encontrado resultados para "' + q + '". Int\u00E9ntalo de nuevo.';
			},
			dym      : function(q, url) {
				return '\u00BFQuisiste decir "<a href="' + url + '">' + q + '</a>"?';
			},
			suggest  : 'Sugerencias',
			suggest1 : 'Comprueba si hay errores ortogr\u00E1ficos',
			suggest2 : 'Eliminar posibles palabras redundantes (como, "productos")',
			suggest3 : 'Utiliza otras palabras para describir lo que est\u00E1s buscando',
			address  : 'Direcci\u00F3n'
		},
		misc       : {
			show : 'Mostrar Filtros',
			hide : 'Quitar Filtros',
			back : function(url) {
				return 'Gracias por usar los filtros. Pero necesitas <a href="' + url + '">REGRESAR</a> y eliminar alguno de ellos para ver resultados.';
			}
		}
	},
	nl : {
		facets     : {
			apply : 'Toepassen',
			clear : 'Wissen',
			show  : 'Toon Filters',
			less  : 'Toon Minder',
			more  : 'Toon Meer'
		},
		summary    : {
			clear   : 'Alles Wissen',
			current : 'Huidige Filters',
			filters : 'Filters'
		},
		compare    : {
			compare  : 'Vergelijk',
			added    : 'Toegevoegd',
			adding   : 'Toevoegen...',
			error    : 'Product kon niet toegevoegd worden',
			selected : 'van 4 items geselecteerd',
			reached  : 'Er kunnen maximaal 4 producten tegelijk worden vergeleken. Als je meer producten wilt toevoegen, verwijder dan een product dat je eerder hebt toegevoegd.',
			remove   : 'Verwijder',
			removed  : 'Product verwijderd van vergelijking'
		},
		ac         : {
			suggestions : 'Top Suggesties',
			noResults   : function(q) {
				return 'Geen resultaten gevonden voor "' + q + '". Probeer een andere zoekterm.';
			},
			total       : function(n, q) {
				var message = (n === 1) ? 'Zie 1 gefilterd resultaat' : ('Zie ' + n + ' gefilterde resultaten');
				return message + (' voor "' + q + '"');
			}
		},
		results    : {
			loading : 'Laden...',
			showing : function(q, oq, url) {
				return 'Weergegeven resultaten voor "<strong>' + q.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;") + '</strong>". Zoek in plaats daarvan naar "<a class="ss-oq-link" href="' + url + '">' + oq.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;") + '</a>".';
			},
			query   : function(q) {
				return q ? ('Zoekresultaten voor "' + q.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;") + '"') : ('Zoekresultaten');
			},
			total   : function(n) {
				return n ? ('Producten (' + n + ')') : ('Producten');
			},
			none    : function(q) {
				return 'We konden geen exacte overeenkomst vinden voor "<strong>' + q.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;") + '</strong>", maar hierbij een aantal vergelijkbare producten...';
			}
		},
		sort       : {
			sort : 'Sorteren',
			by   : 'Sorteren op'
		},
		pagination : {
			all      : 'Toon Alles',
			paginate : 'Toon als pagina',
			total    : 'Totaal aantal Producten'
		},
		noResults  : {
			query    : function(q) {
				return 'Geen resultaten gevonden voor "' + q + '". Probeer een andere zoekterm.';
			},
			dym      : function(q, url) {
				return 'Bedoelde je "<a href="' + url + '">' + q + '</a>"?';
			},
			suggest  : 'Suggesties',
			suggest1 : 'Check voor spelfouten',
			suggest2 : 'Verwijder mogelijk overbodige woorden (bijv. "producten")',
			suggest3 : 'Gebruik andere woorden om te omschrijven waar je naar opzoek bent',
			address  : 'Adres'
		},
		misc       : {
			show : 'Toon Filters',
			hide : 'Verberg Filters',
			back : function(url) {
				return 'Je liefde voor filters is inspirerend, maar je <a href="' + url + '">moet er</a>een paar verwijderen om resultaten te zien.';
			}
		}
	},
	it : {
		facets     : {
			apply : 'Applica',
			clear : 'Rimuovi',
			show  : 'Mostra i filtri',
			less  : 'Mostra di meno',
			more  : 'Mostra di pi\u00F9'
		},
		summary    : {
			clear   : 'Rimuovi i filtri',
			current : 'Filtri applicati',
			filters : 'Filtri'
		},
		compare    : {
			compare  : 'Confronta',
			added    : 'Aggiunto',
			adding   : 'Aggiungendo...',
			error    : 'Non \u00E8 stato possibile aggiungere il prodotto per il confronto',
			selected : 'di 4 prodotti selezionati',
			reached  : '\u00C8 possibile confrontare solo quattro prodotti per volta. Se desideri confrontare un prodotto aggiuntivo, per favore elimina un prodotto dal confronto prima di procedere.',
			remove   : 'Rimuovi',
			removed  : 'Prodotto rimosso dal confronto'
		},
		ac         : {
			suggestions : 'I pi\u00F9 suggeriti',
			noResults   : function(q) {
				return 'Nessuno risultato trovato per "' + q + '". Per favore, effettua una nuova ricerca.';
			},
			total       : function(n, q) {
				var message = (n === 1) ? 'Mostra 1 risultato filtrato' : ('Mostra ' + n + ' risultati filtrati');
				return message + (' per "' + q + '"');
			}
		},
		results    : {
			loading : 'Caricamento...',
			showing : function(q, oq, url) {
				return 'Risultati di ricerca per "<strong>' + q.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;") + '</strong>". Cerca invece "<a class="ss-oq-link" href="' + url + '">' + oq.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;") + '</a>".';
			},
			query   : function(q) {
				return q ? ('Risultati di ricerca per "' + q.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;") + '"') : ('Risultati di ricerca');
			},
			total   : function(n) {
				return n ? ('Prodotti (' + n + ')') : ('Prodotti');
			},
			none    : function(q) {
				return 'Non \u00E8 stata trovata una corrispendenza esatta per "<strong>' + q.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;") + '</strong>", ma potrebbero interessarti questi prodotti simili...';
			}
		},
		sort       : {
			sort : 'Ordinare',
			by   : 'Ordina per'
		},
		pagination : {
			all      : 'Mostra tutto',
			paginate : 'Mostra pagine',
			total    : 'Totale Prodotti'
		},
		noResults  : {
			query    : function(q) {
				return 'Non sono stati trovati risultati di ricerca per "' + q + '". Per favore effettua una nuova ricerca.';
			},
			dym      : function(q, url) {
				return 'Intendevi "<a href="' + url + '">' + q + '</a>"?';
			},
			suggest  : 'Suggeriti',
			suggest1 : 'Verifica eventuali errori di ortografia',
			suggest2 : 'Rimuovi eventuali parole ridondanti (es. "prodotti")',
			suggest3 : 'Utilizza parole diverse per descrivere quello che stai cercando',
			address  : 'Indirizzo'
		},
		misc       : {
			show : 'Mostra filtri',
			hide : 'Nascondi filtri',
			back : function(url) {
				return 'Il tuo amore per i filtri \u00E8 stimolante, ma \u00E8 necessario <a href="' + url + '">tornare INDIETRO</a> e rimuoverne alcuni per poter visualizzare dei risultati.';
			}
		}
	}
}

// Set language
specialized.lang = lang[specialized.region.lang];

// -- END -- LANGUAGE CONFIG

// Get category attributes and set background filters

self.context.backgroundFilters['ss_exclude'] = '0';	
self.context.ac = { context: { ss_exclude: "0" } };
	
if (self.context.category && typeof self.context.category == 'string' && self.context.category != 'shop') {
	specialized.page = 'category';

	if (self.context.category === 'newArrivals'){
		self.context.backgroundFilters['new_arrival'] = 'TRUE';
	} else if (self.context.category === 'blackFriday' || self.context.category === 'cyberMonday'){
		self.context.backgroundFilters['clearance'] = 'true';
	} else {
		self.context.backgroundFilters['categories'] = self.context.category;
	}
}

// Get category name and set page title
if (self.context.categoryName && typeof self.context.categoryName == 'string') {
	specialized.title = self.context.categoryName;
}

// Define all customer groups and fields used by the store
var priceIndex = 0;
var excludePriceGroups = [specialized.group, 'employee', 'prodeal'];
var excludePriceFields = [specialized.price, 'ss_price_employee', 'ss_price_prodeal'];

if(self.context.customer == 'employee') {
	self.context.customer = 'customer';
}

// Check if customer group has changed
if (self.context.customer && typeof self.context.customer == 'string' && (self.context.customer != 'customer' || self.context.customer != 'consumer')) {
	priceIndex = excludePriceGroups.indexOf(self.context.customer);
	if (priceIndex > -1) {
		specialized.group = excludePriceGroups[priceIndex];
		specialized.price = excludePriceFields[priceIndex];
	} else {
		priceIndex = 0;
	}
}

// Remove price fields and groups not applicable
excludePriceGroups.splice(priceIndex, 1);
excludePriceFields.splice(priceIndex, 1);

if (self.context.category && typeof self.context.category == 'string') {
	this.on('beforeBootstrap', function() {
		var delimiter = ':';
		var queryParams = SearchSpring.Catalog.utils.parseQueryString();
		var location = new SearchSpring.Catalog.Location();
		var locationFilters = decodeURIComponent(queryParams['q']).replace(/^\:/gi, '').split(delimiter);
		var locationSort = locationFilters.shift();
		var bgFields = ['archived', 'clearance', 'isbike'];

		if (locationFilters.length) {
			var useQuerySettings = !(location.get('filter').length || location.get('sort').length);

			// Set the first parameter as a sort
			var sortSplit = locationSort.split('-');
			var sortField = convertFields(sortSplit[0].toLowerCase());

			// Set up sort direction based for values that do not have asc or desc
			var sortAsc = ['new'];
			if (sortSplit[1]) {
				var sortDirection = sortSplit[1];
			} else {
				var sortDirection = inArray(sortAsc, sortSplit[0]) ? 'asc' : 'desc';
			}

			// Add sort parameters
			if (useQuerySettings) {
				// They have requested we no longer follow their sort options in their query parameter
				//location.add('sort', sortField, sortDirection);
			}

			// Loop through the search parameters and add the correct pairings
			locationFilters = locationFilters.reduce( function(mapped, filter, index, array) {
				if (index % 2 == 0 && array[index + 1]) {
					var fieldValue = array[index + 1].replace(/\+/gi, ' ');
					var range = false;

					// If the field is a price, we need to parse out numbers and set ranges
					if (filter == 'price') {
						var priceArray = fieldValue.toLowerCase().match(/(?!\$)[0-9]+|(less than)|(greater than)/g);
						if (priceArray[0] == 'less than') {
							range = '*' + delimiter + priceArray[1];
						} else if (priceArray[0] == 'greater than') {
							range = priceArray[1] + delimiter + '*';
						} else {
							range = priceArray[0] + delimiter + priceArray[1];
						}
					}

					mapped.push({
						field : convertFields(filter.toLowerCase()),
						value : fieldValue,
						range : range,
						type  : inString(bgFields, filter.toLowerCase()) ? 'background' : 'filter'
					});
				}
				return mapped;
			}, []);

			// Loop through the location filters and add sidebar filters versus background filters
			for (var k = 0; k < locationFilters.length; k++) {
				var currentFilter = locationFilters[k];
				if (currentFilter.type == 'background') {
					self.context.backgroundFilters[currentFilter.field] = currentFilter.value;
				} else if (useQuerySettings) {
					if (currentFilter.range) {
						var rangeSplit = currentFilter.range.split(delimiter);
						location.add('filter', currentFilter.field, rangeSplit[0], rangeSplit[1]);
					} else {
						location.add('filter', currentFilter.field, currentFilter.value);
					}
				}
			}

			// Go to the add location parameters
			location.go();
		}
	});
}

// Convert special field names where data doesn't map
function convertFields(value) {
	var fieldMapping = {
		colorfamily : 'ss_color_family',
		featured    : 'ga_unique_purchases',
		new         : 'ss_days_since_published',
		price       : specialized.price
	}
	return (fieldMapping[value]) ? fieldMapping[value] : value;
}

self.on('beforeSearch', function(req) {
	// Exclude price facets from the api
	req['excludedFacets'] = excludePriceFields;

	// Reset per page amount to default if a filter summary item has been clicked on
	if (req.resultsPerPage == 500) {
		var keepPerPage;
		angular.forEach(Object.keys(req), function(key) {
			if (key.match(/^filter\./)) {
				keepPerPage = true;
			}
		});

		// Change bgName to you category background filter
		if (req.q != '' || req['bgfilter.categories'] || req.tag) {
			keepPerPage = true;
		}

		if (!keepPerPage && reset) {
			reset.go();
			return false;
		}
	}
});

self.on('afterSearch', function($scope) {
	if (!$scope.moduleName) {
		// Creating reset function for use in beforeSearch
		reset = $scope.location().remove('perpage').remove('filter');
	}
});

// springboard generated variables for autocomplete/default
modules.autocomplete = {
	input           : '.siteSearchInput',
	spellCorrection : spellCondition,
	language        : 'en',
	action          : '//' + specialized.region.domain + '/search/',
	autoPosition    : false,
	limit           : 4
};



this.importer.include('autocomplete2', modules.autocomplete);

// Check if AutoComplete is loading
this.on('afterBootstrap', function() {
	self.on('afterSearch', function($scope) {
		if ($scope.moduleName == 'autocomplete2') {
			setTimeout( function() {
				$scope.$evalAsync( function() {
					$scope.customLoading = false;
					$scope.customResultsLoading = false;
				});
			});
		}
	});
});

this.on('afterBootstrap', function($scope) {
	self.promises['module_autocomplete2'].then(function() {
		// Add class to bodytag when AutoComplete is open
		$scope.$watch('ac.visible', function() {
			var bodyTag = angular.element(document.querySelectorAll('body'));
			var acOpen = 'ss-ac-open';

			if ($scope.ac.visible) {
				bodyTag.addClass(acOpen);
			} else {
				bodyTag.removeClass(acOpen);
			}
		});

		// Check if autocomplete should re-attach or not
		// We need to do this because the form is generated through react
		// and it's not easy to target the input element
		var searchInput = document.querySelectorAll(modules.autocomplete.input);

		self.utils.ensure(function() {
			searchInput = document.querySelectorAll(modules.autocomplete.input);
			return searchInput.length;
		}, function() {
			if (!searchInput[0].className.match('.ng-scope')) {
				// re-attach (or attach first time)
				$scope.ac.attach($scope);
			}
		});

		// Custom click event for AutoComplete
		$scope.acClickEvent = function(acElement) {
			// Check if on touch device
			if (!specialized.touch) {
				window.location.href = acElement.url;
			} else {
				// Initialize a click counter for terms
				if (!acElement.clickCount) {
					acElement.clickCount = 1;
				} else {
					acElement.clickCount += 1;
				}

				// If the click count is greater than 1, go to the url
				if (acElement.clickCount && acElement.clickCount > 1) {
					window.location.href = acElement.url;
				}
			}
		}
	});
});

this.on('afterBootstrap', function($scope) {
	// Add specialized object to scope
	$scope.specialized = specialized;

	// Check if breakpoint has been reached
	angular.element(window).bind('resize', function() {
		$scope.$apply(function() {
			$scope.specialized.mobile = isMobile(mainBp);
			$scope.specialized.sidebar = isMobile(mainBp) ? false : true;
		});
	});

	// Go tot url click function
	$scope.goToUrl = function(url) {
		window.location.href = url;
	}

	$scope.utilities = $scope.utilities || {};

	// Toggle dropdowns
	$scope.utilities.dropdown = {
		open: false,
		show: function(field, ev) {
			ev.stopPropagation();
			this.open = this.open == field ? false : field;
		}
	};

	// Close elements if clicked outside
	angular.element(document).on('click', function() {
		if ($scope.utilities.dropdown.open) {
			$scope.$evalAsync(function() {
				$scope.utilities.dropdown.open = false;
			});
		}
	});
});

// Directive for adding data-src for lazyloading
var lazySrc = 'data-src';
angular.module('SearchSpringCatalog').directive('ssLazySrc', function() {
	return {
		replace: true,
		scope: { 'ssLazySrc' : '=' },
		link: function(scope, elem) {
			elem.attr('data-src', scope.ssLazySrc);

			scope.$watch('ssLazySrc', function(newVal, oldVal) {
				if (newVal != oldVal) {
					elem.removeAttr(lazySrc);
					elem.css('background-image', null);
					setTimeout(function() {
						elem.addClass('lazy').removeClass('lazy');
						elem.attr(lazySrc, newVal);
						elem.css('background-image', 'url(' + newVal.replace("'", "\\'") + ')');
						elem.removeClass('lazy');
					});
				}
			});
		}
	};
});

this.on('afterSearch', function($scope) {

	if ($scope.sorting.options && $scope.sorting.options.length) {
		$scope.sorting.options = $scope.sorting.options.filter(function(option) {
			// Find the active sort option
			option.active = false;
			if ($scope.sorting.current.label == option.label) {
				option.active = true;
			}

			// Check to eclude price fields that are not of the current price group
			option.excludeField = false;
			if (inString(option.label.toLowerCase(), 'price')) {
				if (option.field != specialized.price) {
					option.excludeField = true;
				}
			}
			

			if(option.field == 'instock' && specialized.page != 'category') {
				option.excludeField = true;
			}


			// Return appropriate options
			if (!option.excludeField) return option;
		});
	}

	// Check if there is more than one page (for head title logic)
	$scope.multiplePages = true;
	if ($scope.pagination.totalResults <= $scope.pagination.perPage) {
		$scope.multiplePages = false;
	}

	// Check previous or next links
	$scope.pagination.noPrevious = ($scope.pagination.previous && $scope.pagination.previous.url) ? false : true;
	$scope.pagination.noNext = ($scope.pagination.next && $scope.pagination.next.url) ? false : true;

	// Configure logic for show all / less link
	if (($scope.pagination.totalResults <= 500 && $scope.pagination.totalPages > 1) || $scope.pagination.perPage == 500) {
		if ($scope.pagination.totalPages > 1) {
			specialized.view = 'all';
		} else if ($scope.pagination.totalResults > 30 && $scope.pagination.perPage == 500) {
			specialized.view = 'less';
		}
	}

	angular.forEach($scope.results, function(result) {
		if (isMultiRegion) {
			result.url = updateUrlForRegion(result.url);
		}
		
		// Set error image
		if (!result.ss_image_small || !result.thumbnailImageUrl) {
			var defaultImage = '//s7d5.scene7.com/is/image/Specialized/60519-303_HLMT_MIPS-PADSET-SW-EVADE-II-M_HERO';
			result.ss_image_small = defaultImage + specialized.imgSize + '$';
			result.thumbnailImageUrl = defaultImage + specialized.imgSize2 + '$';
		}

		// Set badge image for display
		if (result.badge) {
			result.badgeImg = '//assets.specialized.com/i/specialized/' + result.badge + '?$hybris-badge$';
		}

		// Update product price based on current group
		if (specialized.group != 'consumer' && result[specialized.price]) {
			result.price = result[specialized.price];
		}

		if (result.ss_product_data) {
			try {
				var productData = JSON.parse(result.ss_product_data);

				// Format some of the product data
				angular.forEach(productData, function(value, key) {
					// Replace any pipes with slashes
					if (value && typeof value == 'string') {
						productData[key] = value.replace(/\|/gi, '/');
					}

					// Update name values
					if (key == 'name' && inString(productData[key], 'QUOTECHARACTER')) {
						productData[key] = productData[key].replace(/QUOTECHARACTER/gi, '&#034;');
					}

					// Set price to appropriate price group
					if (key == 'price') {
						productData[key] = result.price;
					}

					// Update casing of genders
					if (key == 'dimension8') {
						productData[key] = value.replace(/male/gi, 'Male').replace(/female/gi, 'Female').replace(/unisex/gi, 'Unisex');
					}
				});

				// Turn the product data back into a JSON string
				result.ss_product_data = JSON.stringify(productData);
			} catch (error) {
				// nope
			}
		}

		// Check for product pricing logic
		result.price = result.price ? (result.price * 1) : 0;
		result.msrp = result.msrp ? (result.msrp * 1) : 0;
		result.hasPrice = (result.price > 0) ? true : false;
		result.hasSale = (result.msrp > result.price) ? true : false;
	});

	// Hide ss_availability facet from employees
	if (self.context.customer && typeof self.context.customer == 'string' && self.context.customer == 'employee') {
		$scope.facets.grab('ss_availability');
	}

	// Hide ss_availability_2 facet from employees
	if (self.context.customer && typeof self.context.customer == 'string' && (self.context.customer != 'customer' || self.context.customer != 'consumer')) {
		$scope.facets.grab('ss_availability_2');
	}

	angular.forEach($scope.facets, function(facet) {
		// Create different limits for different facet types
		// For palette and grid types, this makes sure boxes fill the last row
		if (facet.type == 'palette' || facet.type == 'grid') {
			facet.limitCount = 18;
		} else {
			facet.limitCount = 12;
		}

		// Update facet label for price based on current group
		if (specialized.group != 'consumer' && inString(facet.field.toLowerCase(), 'price')) {
			facet.label = 'Price';
		}
	});

	// Toggle facet functionality
	$scope.toggleFacet = function(facet) {
		facet.collapse = facet.collapse ? false : true;

		// Don't add jQuery animations if not available
		setTimeout( function() {
			self.utils.ensure(function() {
				return (typeof jQuery == 'function')
			}, function() {
				// Facet selectors
				var facetId = '#ss-' + facet.field;
				var facetTrigger = document.querySelector(facetId + ' ' + specialized.cTrigger);
				var facetContainer = document.querySelector(facetId + ' ' + specialized.cContainer);

				// Set height values
				var heightToggle = angular.element(facetTrigger).hasClass(specialized.cClass) ? facetContainer.scrollHeight : 0;
				var heightEnd = angular.element(facetTrigger).hasClass(specialized.cClass) ? 'auto' : 0;

				jQuery(facetId  + ' ' + specialized.cContainer).animate({
					height: heightToggle
				}, 200, 'linear', function() {
					jQuery(this).height(heightEnd);
				});
			});
		});
	}

	angular.forEach($scope.filterSummary, function(filter) {
		if (filter.field == specialized.price) {
			// Change label for price
			filter.filterLabel = 'Price';

			// Add $ to custom prices as well as any trailing zeros needed
			if (!filter.filterValue.match(/\$/)) {
				var filterArray = filter.filterValue.toLowerCase().match(/(?!\$)[0-9]+|(to \*)|(\* to)/g);
				if (filterArray[0] == '* to') {
					filter.filterValue = 'Less than $' + filterArray[1];
				} else if (filterArray[1] == 'to *') {
					filter.filterValue = 'Greater than $' + filterArray[0];
				} else {
					filter.filterValue = '$' + filterArray[0] + ' to $' + filterArray[1];
				}
			}
		}
	});
});

this.on('domReady', function() {
	self.utils.ensure(function() {
		return (typeof jQuery == 'function')
	}, function() {
		// Set initial height based on collapse states (only if jQuery is available)
		var ssFacets = jQuery('.ss-facets .product-listing-pane__facets-item');

		if (ssFacets && ssFacets.length) {
			ssFacets.each(function() {
				var facetCurrent = jQuery(this);
				var facetHeight = facetCurrent.find(specialized.cTrigger).hasClass(specialized.cClass) ? 'auto' : '0';

				facetCurrent.find(specialized.cContainer).css('height', facetHeight);
			});
		}
	});

	return self.on.UNBIND;
});

// -- START -- DYNAMIC IMAGE LOGIC

// badge text translations
switch (specialized.region.lang) {
	case "en": // english
		specialized.newBadge = 'New';
		specialized.bestSellerBadge = 'Best Seller';
		specialized.comingSoonBadge = 'Coming Soon';
		specialized.preorderBadge = 'Preorder';
		specialized.backorderBadge = 'Backorder';
		specialized.inStoreBadge = 'In Store Pickup Only';
		specialized.exclusiveBadge = 'Exclusive';
		break;
	case "es": // spanish
		specialized.newBadge = 'Nuevo';
		specialized.bestSellerBadge = 'Más vendido';
		specialized.comingSoonBadge = 'Próximamente';
		specialized.preorderBadge = 'Preventa';
		specialized.backorderBadge = 'Pedido pendiente';
		specialized.inStoreBadge = 'Solo retiro en tienda';
		specialized.exclusiveBadge = 'Exclusivo';
		break;
	case "fr": // french
		specialized.newBadge = 'Nouveau';
		specialized.bestSellerBadge = 'Meilleur Vendeur';
		specialized.comingSoonBadge = 'Bientôt disponible';
		specialized.preorderBadge = 'Précommande';
		specialized.backorderBadge = 'Bientôt de retour';
		specialized.inStoreBadge = 'Livraison en magasin';
		specialized.exclusiveBadge = 'Exclusif';
		break;
	case "de": // german
		specialized.newBadge = 'Neu';
		specialized.bestSellerBadge = 'Bestseller';
		specialized.comingSoonBadge = 'Bald erhältlich';
		specialized.preorderBadge = 'Vorbestellbar';
		specialized.backorderBadge = 'Bestellbar';
		specialized.inStoreBadge = 'Abholung im Laden';
		specialized.exclusiveBadge = 'Nur online';
		break;
	case "it": // italian
		specialized.newBadge = 'Novità';
		specialized.bestSellerBadge = 'Il più venduto';
		specialized.comingSoonBadge = 'In arrivo';
		specialized.preorderBadge = 'Pre-ordinabile';
		specialized.backorderBadge = 'Ordinabile';
		specialized.inStoreBadge = 'Solo Ritiro in Negozio';
		specialized.exclusiveBadge = 'Solo Online';
		break;
	case "nl": // dutch
		specialized.newBadge = 'Nieuw';
		specialized.bestSellerBadge = 'Bestseller';
		specialized.comingSoonBadge = 'Binnenkort';
		specialized.preorderBadge = 'Preorder';
		specialized.backorderBadge = 'Backorder';
		specialized.inStoreBadge = 'Alleen In Store Pickup';
		specialized.exclusiveBadge = 'Exclusief';
		break;
	case "fi": // finnish
		specialized.newBadge = 'Uusi';
		specialized.bestSellerBadge = 'Myyntimenestys';
		specialized.comingSoonBadge = 'Tulossa pian';
		specialized.preorderBadge = 'Ennakkotilaus';
		specialized.backorderBadge = 'Jälkitoimitus';
		specialized.inStoreBadge = 'Vain myymälästä nouto';
		specialized.exclusiveBadge = 'Vain verkossa';
		break;
	case "no": // norwegian
		specialized.newBadge = 'Ny';
		specialized.bestSellerBadge = 'Bestselger';
		specialized.comingSoonBadge = 'Kommer snart';
		specialized.preorderBadge = 'Forhåndsbestill';
		specialized.backorderBadge = 'Restordre';
		specialized.inStoreBadge = 'Kun avhent i butikk';
		specialized.exclusiveBadge = 'Eksklusiv';
		break;
	case "se": // swedish
		specialized.newBadge = 'Nyhet';
		specialized.bestSellerBadge = 'Bästsäljare';
		specialized.comingSoonBadge = 'Kommer snart';
		specialized.preorderBadge = 'Kan förbokas';
		specialized.backorderBadge = 'Senare leverans';
		specialized.inStoreBadge = 'Endast hämtning i butik';
		specialized.exclusiveBadge = 'Endast online';
		break;
	case "dk": // danish
		specialized.newBadge = 'Ny';
		specialized.bestSellerBadge = 'Bestseller';
		specialized.comingSoonBadge = 'Kommer snart';
		specialized.preorderBadge = 'Forudbestil';
		specialized.backorderBadge = 'Restordre';
		specialized.inStoreBadge = 'Kun avhent i butik';
		specialized.exclusiveBadge = 'Eksklusiv';
		break;
	case "hr": // croatian
		specialized.newBadge = 'Novo';
		specialized.bestSellerBadge = 'Najprodavanije';
		specialized.comingSoonBadge = 'Dolazi uskoro';
		specialized.preorderBadge = 'Prednarudžba';
		specialized.backorderBadge = 'Donarudžba';
		specialized.inStoreBadge = 'Samo preuzimanje u trgovini';
		specialized.exclusiveBadge = 'Ekskluzivno';
		break;
	case "si": // slovene
		specialized.newBadge = 'Novo';
		specialized.bestSellerBadge = 'Najbolje prodajano';
		specialized.comingSoonBadge = 'Prihaja kmalu';
		specialized.preorderBadge = 'Prednaročilo';
		specialized.backorderBadge = 'Ponaročilo';
		specialized.inStoreBadge = 'Samo preuzimanje u trgovini';
		specialized.exclusiveBadge = 'Ekskluzivno';
		break;
	case "cz": // czech
		specialized.newBadge = 'Novinka';
		specialized.bestSellerBadge = 'Nejprodávanější';
		specialized.comingSoonBadge = 'Brzy skladem';
		specialized.preorderBadge = 'Předobjednávka';
		specialized.backorderBadge = 'Doobjednávka';
		specialized.inStoreBadge = 'Pouze vyzvednutí v obchodě';
		specialized.exclusiveBadge = 'Exkluzivní';
		break;
	case "sk": // slovakian
		specialized.newBadge = 'Novinka';
		specialized.bestSellerBadge = 'Najpredávanejšie';
		specialized.comingSoonBadge = 'Čoskoro skladom';
		specialized.preorderBadge = 'Predobjednávka';
		specialized.backorderBadge = 'Doobjednávka';
		specialized.inStoreBadge = 'Iba na vyzdvihnutie v predajni';
		specialized.exclusiveBadge = 'Exkluzívne';
		break;
	case "pl": // polish
		specialized.newBadge = 'Nowe';
		specialized.bestSellerBadge = 'Bestseller';
		specialized.comingSoonBadge = 'Wkrótce dostępne';
		specialized.preorderBadge = 'Zamówienie przedsprzedażowe';
		specialized.backorderBadge = 'Zamówienie otwarte';
		specialized.inStoreBadge = 'Wyłącznie odbiór w sklepie';
		specialized.exclusiveBadge = 'Ekskluzywnie';
		break;
	default: 
		specialized.newBadge = 'New';
		specialized.bestSellerBadge = 'Best Seller';
		specialized.comingSoonBadge = 'Coming Soon';
		specialized.preorderBadge = 'Preorder';
		specialized.backorderBadge = 'Backorder';
		specialized.inStoreBadge = 'In Store Pickup Only';
		specialized.exclusiveBadge = 'Exclusive';
}

if (specialized.region.lang == 'pt' && specialized.region.code == 'br') {
		specialized.newBadge = 'Lançamento';
		specialized.bestSellerBadge = 'Mais Vendido';
		specialized.comingSoonBadge = 'Em Breve';
		specialized.preorderBadge = 'Oportunidade';
		specialized.backorderBadge = 'Pedido Pendente';
		specialized.inStoreBadge = 'Somente nas Lojas';
		specialized.exclusiveBadge = 'Exclusivo';
} else if (specialized.region.lang == 'pt' && specialized.region.code == 'pt') {
		specialized.newBadge = 'Novidade';
		specialized.bestSellerBadge = 'Mais Vendido';
		specialized.comingSoonBadge = 'Brevemente';
		specialized.preorderBadge = 'Pré-encomenda';
		specialized.backorderBadge = 'Pedido Pendente';
		specialized.inStoreBadge = 'Levantamento em Loja Apenas';
		specialized.exclusiveBadge = 'Exclusivo';
}

var getBadges = function(result, variant) {
	// Start Badge logic
	var badges = {
	    right : [],
	    center : []
	};
	var badge = {};
	
	// var usBestSeller = (specialized.region == 'us' && 
	// 	result.ga_item_revenue && 
	// 	(result.isbike.toLowerCase() == 'false' && result.ga_item_revenue * 1 > 25000) || (result.isbike.toLowerCase() == 'true' && result.ga_item_revenue * 1 > 350000));
	// var gbBestSeller = (specialized.region == 'gb' && 
	//     result.ga_item_revenue && 
	//     (result.isbike.toLowerCase() == 'false' && result.ga_item_revenue * 1 > 3500) || (result.isbike.toLowerCase() == 'true' && result.ga_item_revenue * 1 > 18000));
	// var auBestSeller = (specialized.region.code == 'au' && 
	//     result.ga_item_revenue && 
	//     (result.isbike.toLowerCase() == 'false' && result.ga_item_revenue * 1 > 1000) || (result.isbike.toLowerCase() == 'true' && result.ga_item_revenue * 1 > 10000));
	// var caBestSeller = (specialized.region.code == 'ca' && 
	//     result.ga_item_revenue && 
	//     (result.isbike.toLowerCase() == 'false' && result.ga_item_revenue * 1 > 2000) || (result.isbike.toLowerCase() == 'true' && result.ga_item_revenue * 1 > 6300));
	// var deBestSeller = (specialized.region.code == 'de' && 
	//     result.ga_item_revenue && 
	//     (result.isbike.toLowerCase() == 'false' && result.ga_item_revenue * 1 > 2500) || (result.isbike.toLowerCase() == 'true' && result.ga_item_revenue * 1 > 18000));
	// var brBestSeller = (specialized.region.code == 'br' && 
	//     result.ga_item_revenue && 
	//     (result.isbike.toLowerCase() == 'false' && result.ga_item_revenue * 1 > 3500) || (result.isbike.toLowerCase() == 'true' && result.ga_item_revenue * 1 > 12000));
	// var frBestSeller = (specialized.region.code == 'fr' && 
	//     result.ga_item_revenue && 
	//     (result.isbike.toLowerCase() == 'false' && result.ga_item_revenue * 1 > 3000) || (result.isbike.toLowerCase() == 'true' && result.ga_item_revenue * 1 > 11000));
	// var itBestSeller = (specialized.region.code == 'it' && 
	//     result.ga_item_revenue && 
	//     (result.isbike.toLowerCase() == 'false' && result.ga_item_revenue * 1 > 1000) || (result.isbike.toLowerCase() == 'true' && result.ga_item_revenue * 1 > 6000));
	// var esBestSeller = (specialized.region.code == 'es' && 
	//     result.ga_item_revenue && 
	//     (result.isbike.toLowerCase() == 'false' && result.ga_item_revenue * 1 > 6000) || (result.isbike.toLowerCase() == 'true' && result.ga_item_revenue * 1 > 7000));
	// var ptBestSeller = (specialized.region.code == 'pt' && 
	//     result.ga_item_revenue && 
	//     (result.isbike.toLowerCase() == 'false' && result.ga_item_revenue * 1 > 1000) || (result.isbike.toLowerCase() == 'true' && result.ga_item_revenue * 1 > 6000));
	// var beBestSeller = (specialized.region.code == 'be' && 
	//     result.ga_item_revenue && 
	//     (result.isbike.toLowerCase() == 'false' && result.ga_item_revenue * 1 > 2000) || (result.isbike.toLowerCase() == 'true' && result.ga_item_revenue * 1 > 4000));
	// var chBestSeller = (specialized.region.code == 'ch' && 
	//     result.ga_item_revenue && 
	//     (result.isbike.toLowerCase() == 'false' && result.ga_item_revenue * 1 > 5500) || (result.isbike.toLowerCase() == 'true' && result.ga_item_revenue * 1 > 190000));
	// var nzBestSeller = (specialized.region.code == 'nz' && 
	//     result.ga_item_revenue && 
	//     (result.isbike.toLowerCase() == 'false' && result.ga_item_revenue * 1 > 320) || (result.isbike.toLowerCase() == 'true' && result.ga_item_revenue * 1 > 4500));
	// var atBestSeller = (specialized.region.code == 'at' && 
	//     result.ga_item_revenue && 
	//     (result.isbike.toLowerCase() == 'false' && result.ga_item_revenue * 1 > 500) || (result.isbike.toLowerCase() == 'true' && result.ga_item_revenue * 1 > 5500));
	// var luBestSeller = (specialized.region.code == 'lu' && 
	//     result.ga_item_revenue && 
	//     (result.isbike.toLowerCase() == 'false' && result.ga_item_revenue * 1 > 200) || (result.isbike.toLowerCase() == 'true' && result.ga_item_revenue * 1 > 8500));
	// var nlBestSeller = (specialized.region.code == 'nl' && 
	//     result.ga_item_revenue && 
	//     (result.isbike.toLowerCase() == 'false' && result.ga_item_revenue * 1 > 2500) || (result.isbike.toLowerCase() == 'true' && result.ga_item_revenue * 1 > 7500));

	// var bestSellerByRegion = {
	// 	'us': usBestSeller,
	// 	'gb': gbBestSeller,
	// 	'au': auBestSeller,
	// 	'ca': caBestSeller,
	// 	'de': deBestSeller,
	// 	'br': brBestSeller,
	// 	'fr': frBestSeller,
	// 	'it': itBestSeller,
	// 	'es': esBestSeller,
	// 	'pt': ptBestSeller,
	// 	'be': beBestSeller,
	// 	'ch': chBestSeller,
	// 	'nz': nzBestSeller,
	// 	'at': atBestSeller,
	// 	'lu': luBestSeller,
	// 	'nl': nlBestSeller
	// }

	// use region specific bestseller
	// var isBestSeller = bestSellerByRegion[specialized.region.code];
	
	// use global revenue for bestseller
	// var isBestSeller = result.isbike.toLowerCase() == 'false' && result.ga_item_revenue * 1 > 15000 || result.isbike.toLowerCase() == 'true' && result.ga_item_revenue * 1 > 200000;
	
	// Position 1 priority: New, Best Seller, Coming Soon 
	if ((result.ss_onlinefrom && result.ss_onlinefrom * 1 < 60) && (result.available_qty && result.available_qty * 1 > 0)) {
		badge.img = 'https://assets.specialized.com/i/specialized/ss_badge_New_US_EN.jpg';		
		badge.text = specialized.newBadge;
	} 
	// else if (isBestSeller) {
	// 		badge.text = specialized.bestSellerBadge;
	// }
	else if ((result.ss_onlinefrom && result.ss_onlinefrom * 1 < 120) && (result.available_qty && result.available_qty * 1 == 0) && (result.is_ship_to_home && result.is_ship_to_home.toLowerCase() == 'true')) {
		badge.img = 'https://assets.specialized.com/i/specialized/ss_badge_ComingSoon_US_EN.jpg';
		// badge.text = 'Coming Soon';
		badge.text = specialized.comingSoonBadge;
	}

	if (badge.text) {
		badge.position = 1;
		badges.right.push(badge);
	}
	
	// Position 2 priority: Pre-Order, Backorder, In Store Pickup Only
	badge = {};
	
	if (result.preorder && result.preorder.toLowerCase() == 'true') {
		badge.img = 'https://assets.specialized.com/i/specialized/ss_badge_Preorder_US_EN.jpg';
		// badge.text = 'Preorder';
		badge.text = specialized.preorderBadge;
	} else if (result.backorder && result.backorder.toLowerCase() == 'true') {
		badge.img = 'https://assets.specialized.com/i/specialized/ss_badge_Backorder_US_EN.jpg';
		// badge.text = 'Backorder';
		badge.text = specialized.backorderBadge;
	} else if ((result.is_cnc && result.is_cnc.toLowerCase() == 'true') && (result.is_home_delivery && result.is_home_delivery.toLowerCase() == 'false') && (result.is_ship_to_home && result.is_ship_to_home.toLowerCase() == 'false')) {
		badge.img = 'https://assets.specialized.com/i/specialized/ss_badge_InStorePickupOnly_US_EN.jpg';
		// badge.text = 'In Store Pickup Only';
		badge.text = specialized.inStoreBadge;
	}

	if (badge.text) {
		badge.position = 1;
		badges.center.push(badge);
	}
	
	// Postion 4 priority: ss_discount // displays above Position 3 badge
	// badge = {};
			
	// if (result.ss_discount && result.ss_discount > 0) {
	// 	badge.text = result.ss_discount + '% off'
	// }
	
	// if (badge.text) {
	// 	badge.position = 3;
	// 	badges.right.push(badge);
	// }
	
	// Position 3 priority: Exclusive
	badge = {};
		
	if (variant && variant.is_exclusive && variant.is_exclusive.toLowerCase() == 'true') {
		badge.img = 'https://assets.specialized.com/i/specialized/ss_badge_Exclusive_US_EN.jpg';
		// badge.text = 'Exclusive';
		badge.text = specialized.exclusiveBadge;
	}
	
	if (badge.text) {
		badge.position = 2;
		badge.override = badges.length && badges[0].position == 1 ? false : true;
		
		badges.right.push(badge);
	}

	variant.badges = badges;
	return variant;
	// End Badge Logic
}

var colorFilters = [];
var variantCache = {};

var swapVariants = function(result, variant) {
	// plpImageId should be used before thumbnail
	if (variant.plpImageId) {
		result.thumbnailImageUrl = variant.plpImageId;
	} else if (variant.thumbnail) {
		result.thumbnailImageUrl = variant.thumbnail;
	}

	// Update prices and url
	if (variant.finalPrice || variant.colorLink) {
		if (variant.finalPrice && specialized.region.location != 'Australia') {
			result.price = (variant.finalPrice * 1);
			result.hasPrice = (result.price > 0) ? true : false;
			result.hasSale = (result.msrp > result.price) ? true : false;
		}
		if (variant.colorLink) {
			if (isMultiRegion) {
				result.url = updateUrlForRegion(variant.colorLink);
			} else {
				result.url = variant.colorLink;
			}
		}
	}

	getBadges(result, variant);
	result.selectedVariant = variant;
};

this.on('afterBootstrap', function($scope) {
	$scope.swapVariants = swapVariants;
});

this.on('beforeSearch', function($req) {
	// Add selected colors to color filters array
	colorFilters = $req['filter.ss_color_family'];

	// If color filters is present, join and toLowerCase
	if (colorFilters) {
		colorFilters = colorFilters.join('|').toLowerCase().split('|');
	}
});

this.on('afterSearch', function($scope) {
	$scope.isClearancePage = (self.context.backgroundFilters && self.context.backgroundFilters.clearance && self.context.backgroundFilters.clearance == 'true');

	// Loop through results for colors
	angular.forEach($scope.results, function(result) {
		// Check if there are extra images available
		if (result.ss_swatches) {
			try {
				// Parse out the JSON for variant goodness
				if (!variantCache[result.id]) {
					variantCache[result.id] = JSON.parse(result.ss_swatches);
				}
				result.ss_swatches = angular.copy(variantCache[result.id]);

				if ($scope.isClearancePage) {
					var clearanceSwatches = result.ss_swatches.filter(function(swatch) {
						return swatch.clearance !== 'False';
					});

					if (clearanceSwatches.length > 0) {
						result.ss_swatches = clearanceSwatches;
					}
				}

				if (result.ss_swatches.length) {
					var colorSearch;

					// Loop through the new variants
					for (var i = 0; i < result.ss_swatches.length; i++) {
						var variant = result.ss_swatches[i];

						// Split up id (mostly for compare)
						var idSplit = variant.id.split('-');
						variant.lastId = (idSplit.length) ? idSplit[idSplit.length - 1] : variant.id;

						// Update variant details
						variant.plpImageId = variant.plpImageId ? updateImage(variant.plpImageId) : false;
						variant.thumbnail = variant.thumbnail ? updateImage(variant.thumbnail) : false;
						variant.hex = variant.swatch ? (variant.swatch.split('::')) : false;
						variant.colorLink = removeHttp(variant.colorLink).replace('//www.specialized.com', '');
						variant.finalPrice = variant.price.replace(' ' + specialized.region.code2, '');

						// Loop through the prices to get base price
						for (var j = 0; j < variant.prices.length; j++) {
							var currentPrice = variant.prices[j];
							if ((currentPrice.group == specialized.group) && currentPrice.minPrice) {
								currentPrice.minPrice = currentPrice.minPrice.replace(' ' + specialized.region.code2, '');
								if ((currentPrice.minPrice * 1) < (variant.price * 1)) {
									variant.finalPrice = currentPrice.minPrice;
								}
							}
						}

						// Variant.weight = tally of matched terms
						variant.weight = 0;
						if (result.defaultcolorid && result.defaultcolorid == variant.id) {
							variant.weight = 2;
						} else if (variant.thumbnail == result.thumbnailImageUrl) {
							variant.weight = 1;
						}

						// Set the simple and group color through the variant object
						var simpleColor = variant.color ? variant.color.toLowerCase() : '';
						var groupColors;
						if (variant.colorFamily) {
							if (Array.isArray(variant.colorFamily)) {
								groupColors = variant.colorFamily.map(function(color) {
									return color.toLowerCase();
								});
							} else if (variant.colorFamily) {
								groupColors = [variant.colorFamily.toLowerCase()];
							}
						} else {
							groupColors = '';
						}

						// Check selected color filter matches
						angular.forEach(colorFilters, function(color, i) {
							var multiplier = (i + 1);

							// Check simple color and group color to see if there is a color match
							if ((simpleColor && simpleColor == color) || inString(simpleColor, color)) {
								variant.weight += (10 * multiplier);
							} else if (groupColors.length) {
								angular.forEach(groupColors, function(groupColor) {
									if (groupColor == color || inString(groupColor, color)) {
										variant.weight += (5 * multiplier);
									}
								});
							}
						});

						// Check search terms also
						if ($scope.q) {
							var terms = $scope.q.toLowerCase().split(' ');
							var simpleColors = simpleColor.replace('/', ' ').split(' ');

							angular.forEach(terms, function(term, i) {
								var multiplier = (i + 1);

								angular.forEach(simpleColors, function(simpleColor) {
									if (term == simpleColor || inString(simpleColor, term)) {
										variant.weight += (1 * multiplier);
										colorSearch = true;
									}
								});

								angular.forEach(groupColors, function(groupColor) {
									if (term == groupColor || inString(groupColor, term)) {
										variant.weight += (1 * multiplier);
										colorSearch = true;
									}
								});
							});
						}
					}

					// Find greatest weight in queried variants and select it!
					result.ss_swatches.sort(function(a, b) {
						return b.weight - a.weight;
					});

					// Use the first element in array (highest weight)
					swapVariants(result, result.ss_swatches[0]);
				}
			} catch (error) {
				// nope
			}
		}
	});
});

// -- END -- DYNAMIC IMAGE LOGIC

// -- START -- COMPARE LOGIC

// Set empty object for compare cache
var compareCache = {}

// HTML and icons for compare
var buildSVG = function(icon, size, label, inner) {
	return '<span class="' + icon + ' svg-icon"><svg width="' + size + '" height="' + size + '" viewBox="0 0 ' + size + ' ' + size + '">' + inner + '</svg></span><label>' + label + '</label>'
}

var compareHtml = {
	compare : buildSVG('plus-icon', 32, specialized.lang.compare.compare, '<polyline points="18.3,0 18.3,11.4 18.3,13.7 20.6,13.7 32,13.7 32,18.3 20.6,18.3 18.3,18.3 18.3,20.6 18.3,32 13.7,32 13.7,20.6 13.7,18.3 11.4,18.3 0,18.3 0,13.7 11.4,13.7 13.7,13.7 13.7,11.4 13.7,0 18.3,0 "></polyline>'),
	adding  : buildSVG('plus-icon', 32, specialized.lang.compare.adding, '<polyline points="18.3,0 18.3,11.4 18.3,13.7 20.6,13.7 32,13.7 32,18.3 20.6,18.3 18.3,18.3 18.3,20.6 18.3,32 13.7,32 13.7,20.6 13.7,18.3 11.4,18.3 0,18.3 0,13.7 11.4,13.7 13.7,13.7 13.7,11.4 13.7,0 18.3,0 "></polyline>'),
	added   : buildSVG('icon-svg-check', 32, specialized.lang.compare.added, '<polyline points="29.4,4.8 32,7.4 11.1,28.2 0,17.1 2.6,14.5 9.4,21.3 11.1,23 12.9,21.3 29.4,4.8"></polyline>'),
	remove  : buildSVG('icon-cross', 32, specialized.lang.compare.remove, '<polyline points="32,3.3 20.9,14.4 19.3,16 20.9,17.6 32,28.7 28.7,32 17.6,20.9 16,19.3 14.4,20.9 3.3,32.1 0,28.8 11.1,17.6 12.7,16 11.1,14.4 0,3.3 3.3,0 14.4,11.1 16,12.7 17.6,11.1 28.7,0 32,3.3 "></polyline>'),
	cannot  : buildSVG('block-icon', 24, specialized.lang.compare.error, '<path d="M0 0h24v24H0z" fill="none"></path><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zM4 12c0-4.42 3.58-8 8-8 1.85 0 3.55.63 4.9 1.69L5.69 16.9C4.63 15.55 4 13.85 4 12zm8 8c-1.85 0-3.55-.63-4.9-1.69L18.31 7.1C19.37 8.45 20 10.15 20 12c0 4.42-3.58 8-8 8z"></path>')
}

this.on('afterBootstrap', function($scope) {
	// Create compare click event
	$scope.triggerCompare = function(result, e) {
		// Set compare clicked to true so we know a button was clicked
		result.compare.clicked = true;

		// Add or remove products using compare events
		if (typeof window.ACC.productCompare == 'object' && typeof window.ACC.productCompare.addProduct == 'function' && typeof window.ACC.productCompare.removeProduct == 'function') {
			if (result.compare.active) {
				window.ACC.productCompare.removeProduct({code : result.selectedVariant.lastId}, removeWithinTray = true, e);
			} else {
				if (specialized.showCompare) {
					result.compare.html = compareHtml.adding;
					window.ACC.productCompare.addProduct({code : result.selectedVariant.id});
				} else {
					result.compare.cannot = true;
					result.compare.html = compareHtml.cannot;
					setTimeout(function() {
						result.compare.html = compareHtml.compare;
						delete result.compare.cannot;
						$scope.$evalAsync();
					}, 1000);
				}
			}
		} else {
			return false;
		}
	}

	if (!$scope.moduleName) {
		// Check event listener for when product has been added or removed
		window.addEventListener('productCompareFetched', function(e) {
			compareCache = e.detail;

			// Determine if we should show compare buttons or not
			specialized.showCompare = (compareCache && Object.keys(compareCache).length > 3) ? false : true;

			angular.forEach($scope.results, function(result) {
				if (result.compare && !result.compare.active && compareCache[result.selectedVariant.lastId]) {
					// If compare was done by a click, add transitions for button text
					if (result.compare.clicked) {
						result.compare = {
							active  : true,
							clicked : false,
							html    : compareHtml.added
						};
						$scope.$evalAsync();

						setTimeout(function() {
							result.compare.html = compareHtml.remove;
							$scope.$evalAsync();
						}, 1000);
					} else {
						result.compare = {
							active  : true,
							clicked : false,
							html    : compareHtml.remove
						};
						$scope.$evalAsync();
					}
				} else if (result.compare.active && !compareCache[result.selectedVariant.lastId]) {
					result.compare = {
						active  : false,
						clicked : false,
						html    : compareHtml.compare
					};
					$scope.$evalAsync();
				}
			});
		});
	}
});

this.on('afterSearch', function($scope) {
	if (!$scope.moduleName) {
		compareCache = getProductsInCompare();

		// Determine if we should show compare buttons or not
		specialized.showCompare = (compareCache && Object.keys(compareCache).length > 3) ? false : true;

		angular.forEach($scope.results, function(result) {
			// Set initial compare object
			if (result.selectedVariant && compareCache[result.selectedVariant.lastId]) {
				result.compare = {
					active  : true,
					clicked : false,
					html    : compareHtml.remove
				};
			} else {
				result.compare = {
					active  : false,
					clicked : false,
					html    : compareHtml.compare
				};
			}
		});
	}
});



function getProductsInCompare() {
	var addedToCompare = {};
	if (window.localStorage['productCompareItems']) {
		var addedArray = window.localStorage['productCompareItems'].split(',');
		for (var i = 0; i < addedArray.length; i++) {
			var currentAdded = (addedArray[i] * 1);
			addedToCompare[currentAdded] = {};
		}
	}
	return addedToCompare;
}

// -- END -- COMPARE LOGIC

this.on('domReady', function() {
	var ssResults = angular.element(document.querySelectorAll('.ss-results .product-listing-pane__results .product-list__item'));

	self.utils.ensure(function() {
		return (typeof jQuery == 'function')
	}, function() {
		// Add sticky class when scrolling
		if (ssResults && ssResults.length) {
			addOnScroll('.ss-results-title', '#result-list', 'ss-sticky-title');
		}
	});

	self.utils.ensure(function() {
		return (window.ACC && typeof window.ACC.lazyload == 'function')
	}, function() {
		if (ssResults && ssResults.length) {
			window.ACC.lazyload();
		}
	});
});

function addOnScroll(selector, anchor, stickyClass) {
	var windowSelector = jQuery(window);

	if (windowSelector && windowSelector.length) {
		// Variables for scroll logic
		var anchor = jQuery(anchor).offset().top;
		var scrollCheck = false;

		windowSelector.scroll( function() {
			if (scrollCheck == false) {
				if (windowSelector.scrollTop() > anchor) {
					jQuery( selector ).addClass(stickyClass);
					scrollCheck = true;
				}
			} else {
				if (windowSelector.scrollTop() <= anchor) {
					jQuery( selector ).removeClass(stickyClass);
					scrollCheck = false;
				}
			}
		});
	}
}

// Check to see if value is in array
function inArray(array, value) {
	return (array.indexOf(value) > -1) ? true : false;
}

// Check to see if value is in string
function inString(string, value) {
	return (string && string.indexOf(value) !== -1) ? true : false;
}

// Remove  http or https (mostly for grid banners)
function removeHttp(value) {
	return value.replace(/^http(s?):/i, '');
}

// Update images and set image sizes
function updateImage(image) {
	return removeHttp(image).replace(specialized.imgReplace, specialized.imgSize2);
}

// Check if on mobile
function isMobile(bp) {
	var widthCalc = (window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth);
	return widthCalc <= bp;
}

function updateUrlForRegion(url) {
	var match = window.location.pathname.match(/^\/([a-z]{2})/);
	if(match) {
		var region = match[1];
		return url.replace(/^\/[a-z]{2}/, '/' + region);
	}
	
	return url;
}

this.on('afterSearch', function($scope) {
	// Add inline merchandising banners
	if ($scope.pagination.totalResults && $scope.merchandising && $scope.merchandising.content && $scope.merchandising.content.inline) {
		// Variables for banner positions beyond pagination index
		var tailBanners = [];
		var bannerBegin = $scope.pagination.begin - 1;
		var bannerEnd = $scope.pagination.end;

		$scope.merchandising.content.inline.sort(function(a, b) {
			return a.config.position.index - b.config.position.index;
		}).filter(function(banner) {
			var index = banner.config.position.index;

			if (index >= bannerBegin) {
				if (index <= bannerEnd - 1) {
					return true;
				} else {
					tailBanners.push(bannerToResult(banner));
				}
			}
		}).map(function(banner) {
			var adjustedIndex = $scope.infinite ? banner.config.position.index : (banner.config.position.index - bannerBegin);
			$scope.results.splice(adjustedIndex, 0, bannerToResult(banner));
		});

		var missingBegin = $scope.infinite ? 0 : bannerBegin;
		var totalResults = Math.min($scope.pagination.totalResults, bannerEnd);
		var missingResults = totalResults - (missingBegin + $scope.results.length);

		if (missingResults) {
			var sliceStart = ($scope.pagination.nextPage == 0) ? (tailBanners.length - missingResults) : 0;
			var missingBanners = tailBanners.slice(sliceStart, sliceStart + missingResults);
			angular.forEach(missingBanners, function(missingBanner) {
				$scope.results.push(missingBanner);
			});
		}
	}
});

function bannerToResult(banner) {
	return {
		uid            : 'ssib-' + banner.config.position.index,
		isInlineBanner : true,
		content        : banner.value
	}
}

//dispatch IS event
this.on('domReady', function() {
	window.dispatchEvent(new CustomEvent("DOMContentLoaded", {}));
});
};
SearchSpring.Catalog.templates.promises.receive.resolve('<!-- Stylesheet --><link rel="stylesheet" href="//cdn.searchspring.net/ajax_search/sites/c1kac2/css/c1kac2.css"><!-- AutoComplete --><script type="text/ss-template" name="AutoComplete" target="[ss-autocomplete]">	<div class="ss-ac-container" ng-show="ac.visible" ng-class="{\'no-terms\': ac.terms.length == 0}">		<div id="ss-ac-terms" ng-show="ac.terms">			<ul class="ss-list ss-flex-inline-nowrap-center">				<li ng-repeat="term in ac.terms | limitTo:4" class="ss-list-option" ng-class="{\'ss-active\': term.active}">					<a ng-bind-html="term.label | trusted" ss-no-ps ss-nav-selectable ng-focus="ac.customLoading = true; term.preview()" ng-click="acClickEvent(term)" class="ss-list-link ss-ac-underline ss-pointer"></a>				</li>			</ul>		</div>		<div id="ss-ac-content" class="ss-flex-wrap" ng-class="{\'ss-ac-loading\': ac.customLoading, \'ss-ac-not-loading\': !ac.customLoading}">			<div id="ss-ac-facets" ng-show="ac.facets">				<div class="ss-ac-facets-row">					<div ng-repeat="facet in ac.facets | filter:{ type: \'!slider\' } | limitTo:3" ng-switch="facet.type" ng-if="facet.values.length" id="ss-ac-{{ facet.field }}" class="ss-ac-facet-container" ng-class="{\'ss-ac-facet-container-list\': (facet.type != \'grid\' || facet.type != \'palette\' || !facet.type), \'ss-ac-facet-container-palette\': facet.type == \'palette\', \'ss-ac-facet-container-grid\': facet.type == \'grid\'}">						<h4 class="ss-title">{{ facet.label }}</h4>						<ul ng-switch-default class="ss-list">							<li ng-repeat="value in facet.values | limitTo:3" class="ss-list-option" ng-class="{\'ss-active\': value.active}">								<a ss-no-ps ss-nav-selectable ng-focus="ac.customResultsLoading = true; value.preview()" ng-click="acClickEvent(value)" class="ss-list-link ss-ac-underline ss-pointer">									{{ value.label }}								</a>							</li>						</ul>					</div>				</div>			</div>			<div id="ss-ac-results" ng-class="{\'ss-ac-loading\': ac.customResultsLoading, \'ss-ac-not-loading\': !ac.customResultsLoading}">				<h4 class="ss-title">{{ specialized.lang.ac.suggestions }}</h4>				<ul ng-if="ac.results.length" class="ss-ac-item-container">					<li class="ss-ac-item" ng-repeat="result in ac.results | limitTo:ac.pagination.perPage">						<a ng-href="{{ result.url }}" ss-no-ps ss-nav-selectable>							<div class="ss-ac-item-image">								<div class="ss-image-wrapper" ng-style="{\'background-image\': \'url(\' + result.ss_image_small + \')\'}" alt="{{ result.name }}" title="{{ result.name }}"></div>							</div>							<div class="ss-ac-item-details">								<p class="ss-ac-item-name">{{ result.name | truncate:50:\'&hellip;\' }}</p>								<p ng-if="result.hasPrice" class="ss-ac-item-price">									<span class="ss-ac-item-regular" ng-class="{\'ss-ac-item-on-sale\': result.hasSale}">										{{ ((result.price | currency : specialized.region.prefix : specialized.region.decimal : specialized.region.thousand : specialized.region.cent) | split : specialized.region.split)[0] }}{{ specialized.region.suffix }}									</span>									<span ng-if="result.hasSale" class="ss-ac-item-msrp">										{{ ((result.msrp | currency : specialized.region.prefix : specialized.region.decimal : specialized.region.thousand : specialized.region.cent) | split : specialized.region.split)[0] }}{{ specialized.region.suffix }}									</span>								</p>							</div>						</a>					</li>				</ul>				<div ng-if="!ac.results.length" class="ss-ac-no-results">					<p>{{ specialized.lang.ac.noResults(ac.q) }}</p>				</div>				<div id="ss-ac-see-more" ng-class="{\'ss-ac-see-more-padding\': ac.facets.length}">					<a href="" ng-click="goToUrl(ac.location.remove(\'perpage\').url()); ac.visible = false;" class="ss-ac-see-more-link" ss-nav-selectable>						{{ specialized.lang.ac.total(ac.pagination.totalResults, ac.q) }}					</a>				</div>			</div>		</div>	</div></script><!-- Global Backdrop --><script type="text/ss-template" name="Global Backdrop" target=".page-productListPage .global-backdrop-container, .page-search  .global-backdrop-container">	<div ng-if="specialized.mobile && specialized.sidebar" id="global-backdrop" class="global-backdrop" ng-class="{\'fade-leave fade-leave-active\': !specialized.sidebar}" ng-click="specialized.sideToggle()"></div></script><!-- SearchSpring Sidebar --><script type="text/ss-template" name="SearchSpring Sidebar" target="#searchspring-sidebar">	<div class="product-listing-pane__facets-inner">		<a class="product-listing-pane__mobile-close ss-pointer" ng-click="specialized.sideToggle()">			<span class="ss-svg-icon icon-cross">				<svg viewBox="0 0 32 32"><polyline points="32,3.3 20.9,14.4 19.3,16 20.9,17.6 32,28.7 28.7,32 17.6,20.9 16,19.3 14.4,20.9 3.3,32.1 0,28.8 11.1,17.6 12.7,16 11.1,14.4 0,3.3 3.3,0 14.4,11.1 16,12.7 17.6,11.1 28.7,0 32,3.3 "></polyline></svg>			</span>		</a>		<ul class="ss-sorting"></ul>		<ul ng-if="filterSummary.length" class="ss-summary"></ul>		<ul ng-if="facets.length" class="ss-facets"></ul>	</div></script><!-- Sorting - Mobile --><script type="text/ss-template" name="Sorting - Mobile" target=".ss-sorting">	<li class="product-listing-pane__facets-item product-listing-pane__sort-list">		<label>{{ specialized.lang.sort.sort }}</label>		<ul class="product-listing-pane__facet-values-list">			<li class="product-listing-pane__facet-values-list-item" ng-repeat="option in sorting.options" ng-if="!option.hide">				<div class="react-custom-checkbox" ng-class="{\'react-custom-checkbox-active\': option.active}">					<input ng-click="option.go()" ng-model="option.active" type="checkbox" id="{{ option.value }}" tabindex="-1">					<svg ng-if="option.active" viewBox="0 0 32 32" height="32" width="32" tabindex="-1"><polyline points="29.4,4.8 32,7.4 11.1,28.2 0,17.1 2.6,14.5 9.4,21.3 11.1,23 12.9,21.3 29.4,4.8"></polyline></svg>					<svg ng-if="!option.active" viewBox="0 0 32 32" height="32" width="32" tabindex="-1"></svg>					<label for="{{ option.value }}" tabindex="0">{{ option.label }}</label>				</div>			</li>		</ul>	</li></script><!-- Filter Summary --><script type="text/ss-template" name="Filter Summary" target=".ss-summary">	<li class="product-listing-pane__facets-item">		<label>{{ specialized.lang.summary.current }}</label>		<ul class="product-listing-pane__facet-values-list">			<li class="product-listing-pane__facet-values-list-item" ng-repeat="filter in filterSummary">				<div class="react-custom-checkbox react-custom-checkbox-cross">					<input ng-click="filter.remove.go()" type="checkbox" id="{{ filter.label | handleize }}" tabindex="-1">					<svg ng-click="filter.remove.go()" viewBox="0 0 32 32" height="32" width="32"><polyline points="32,3.3 20.9,14.4 19.3,16 20.9,17.6 32,28.7 28.7,32 17.6,20.9 16,19.3 14.4,20.9 3.3,32.1 0,28.8 11.1,17.6 12.7,16 11.1,14.4 0,3.3 3.3,0 14.4,11.1 16,12.7 17.6,11.1 28.7,0 32,3.3 "></polyline></svg>					<label for="{{ filter.label | handleize }}" tabindex="0">						<strong>{{ filter.filterLabel }}:</strong> {{ filter.filterValue }}					</label>				</div>			</li>			<li class="product-listing-pane__facet-values-list-item">				<div class="react-custom-checkbox react-custom-checkbox-cross">					<input ng-click="location().remove(\'filter\').remove(\'rq\').go()" type="checkbox" id="summary-clear-all" tabindex="-1">					<svg ng-click="location().remove(\'filter\').remove(\'rq\').go()" viewBox="0 0 32 32" height="32" width="32"><polyline points="32,3.3 20.9,14.4 19.3,16 20.9,17.6 32,28.7 28.7,32 17.6,20.9 16,19.3 14.4,20.9 3.3,32.1 0,28.8 11.1,17.6 12.7,16 11.1,14.4 0,3.3 3.3,0 14.4,11.1 16,12.7 17.6,11.1 28.7,0 32,3.3 "></polyline></svg>					<label for="summary-clear-all" tabindex="0">						<strong>{{ specialized.lang.summary.clear }}</strong>					</label>				</div>			</li>		</ul>	</li></script><!-- Facets --><script type="text/ss-template" name="Facets" target=".ss-facets">	<li ng-repeat="facet in facets track by facet.field" ng-switch="facet.type" id="ss-{{ facet.field }}" class="product-listing-pane__facets-item product-listing-pane__facets-item-{{ facet.type ? facet.type : \'list\' }}">		<div class="Collapsible">			<span class="Collapsible__trigger" ng-class="{\'is-open\': !facet.collapse, \'is-closed\': facet.collapse}">				<label ng-click="toggleFacet(facet)">					{{ facet.label }}					<span ng-if="!facet.collapse" class="ss-svg-icon minus-icon">						<svg viewBox="0 0 32 32"><rect y="13.7" width="32" height="4.6"></rect></svg>					</span>					<span ng-if="facet.collapse" class="ss-svg-icon plus-icon">						<svg viewBox="0 0 32 32"><polyline points="18.3,0 18.3,11.4 18.3,13.7 20.6,13.7 32,13.7 32,18.3 20.6,18.3 18.3,18.3 18.3,20.6 18.3,32 13.7,32 13.7,20.6 13.7,18.3 11.4,18.3 0,18.3 0,13.7 11.4,13.7 13.7,13.7 13.7,11.4 13.7,0 18.3,0 "></polyline></svg>					</span>				</label>			</span>			<div class="Collapsible__contentOuter">				<div class="Collapsible__contentInner">					<ul ng-switch-when="grid" class="product-listing-pane__facet-values-list ss-grid">						<li ng-repeat="value in facet.values | limitTo:facet.overflow.limit" class="product-listing-pane__facet-values-list-item product-listing-pane__facet-values-brick" ng-class="{\'product-listing-pane__facet-values-brick-active\': value.active}">							<button ng-click="value.go()" tabindex="0" class="ss-grid-button">{{ value.label }}</button>						</li>					</ul>					<ul ng-switch-when="palette" class="product-listing-pane__facet-values-list ss-palette">						<li ng-repeat="value in facet.values | limitTo:facet.overflow.limit" class="product-listing-pane__facet-values-list-item product-listing-pane__facet-values-color" ng-class="{\'product-listing-pane__facet-values-color-active\': value.active}">							<button ng-click="value.go()" color="{{ value.label }}" tabindex="0" class="ss-palette-button" ng-style="{\'background-color\': (value.label | handleize)}"></button>						</li>					</ul>					<ul ng-switch-default class="product-listing-pane__facet-values-list ss-list" ng-class="{\'ss-show-overflow\': facet.overflow.remaining != facet.overflow.count}">						<li class="product-listing-pane__facet-values-list-item" ng-repeat="value in facet.values | limitTo:facet.overflow.limit">							<div class="react-custom-checkbox" ng-class="{\'react-custom-checkbox-active\': value.active}">								<input ng-click="value.go()" ng-model="value.active" type="checkbox" id="{{ facet.field }}-{{ value.label | handleize }}-{{ $index }}" tabindex="-1">								<svg ng-click="value.go()" ng-if="value.active" viewBox="0 0 32 32" height="32" width="32" tabindex="-1"><polyline points="29.4,4.8 32,7.4 11.1,28.2 0,17.1 2.6,14.5 9.4,21.3 11.1,23 12.9,21.3 29.4,4.8"></polyline></svg>								<svg ng-if="!value.active" viewBox="0 0 32 32" height="32" width="32" tabindex="-1"></svg>								<label for="{{ facet.field }}-{{ value.label | handleize }}-{{ $index }}" tabindex="0">{{ value.label }} <span class="ss-facet-count">({{ value.count }})</span></label>							</div>						</li>					</ul>					<div ng-if="facet.overflow.set(facet.limitCount).count" class="ss-show-more" ng-class="{\'ss-expanded\': facet.overflow.remaining, \'ss-collapsed\': !facet.overflow.remaining}">						<label ng-click="facet.overflow.toggle()" class="ss-show-more-link ss-pointer">							{{ facet.overflow.remaining ? specialized.lang.facets.more : specialized.lang.facets.less }}						</label>					</div>				</div>			</div>		</div>	</li></script><!-- Search Breadcrumbs --><script type="text/ss-template" name="Search Breadcrumbs" target=".page-search .breadcrumbs-wrapper .breadcrumbs .active">	<a href="/" class="last" itemprop="item">		<span itemprop="name">{{ specialized.lang.results.query(q) }}</span>	</a>	<meta itemprop="position" content="1" /></script><!-- Search Tab No Product Count --><script type="text/ss-template" name="Search Tab No Product Count" target=".page-search .tab-container #results-products:not(.gor-active)">	{{ specialized.lang.results.total(false) }}</script><!-- Search Tab With Product Count --><script type="text/ss-template" name="Search Tab With Product Count" target=".page-search .tab-container #results-products.gor-active, .page-search .search-results-heading #header-products">	{{ specialized.lang.results.total(pagination.totalResults) }}</script><!-- Results & No Results --><script type="text/ss-template" name="Results &amp; No Results" module="search" target="#searchspring-content">	<div class="loadingOverlay loadingOverlay--top" id="listingOverlay" ng-style="{\'display\': loading || infinite.loading ? \'flex\' : \'none\'}">		<h1>{{ specialized.lang.results.loading }}</h1>	</div>	<div ng-if="pagination.totalResults" class="ss-results product-listing-pane">		<div ng-if="originalQuery" class="product-listing-pane__oq ss-oq" ng-bind-html="specialized.lang.results.showing(q, originalQuery.value, originalQuery.url) | trusted"></div>		<div ng-if="query.matchType==\'expanded\'" class="product-listing-pane__expanded ss-expanded-search" ng-bind-html="specialized.lang.results.none(q) | trusted"></div>		<div ng-if="merchandising.content.header.length > 0" id="ss-merch-header" class="ss-merchandising" ss-merchandising="header"></div>		<div class="product-listing-pane__actions">			<div class="product-listing-pane__action-column">				<h3 ng-if="specialized.page == \'category\'" class="ss-results-title">{{ specialized.title }}</h3>				<h3 ng-if="specialized.page != \'category\'" class="ss-results-title">{{ specialized.lang.results.query(q) }}</h3>			</div>			<div></div>			<div class="product-listing-pane__action-column product-listing-pane__action-column--right-column">				<div class="product-listing-pane__sort">					<label>{{ specialized.lang.sort.by }}:</label>					<div class="react-select">						<div class="react-select__control ss-flex-wrap-center ss-pointer" ng-class="{\'react-select__control--menu-is-open\': utilities.dropdown.open == sorting.current.label}" ng-click="utilities.dropdown.show(sorting.current.label, $event)">							<div class="react-select__value-container react-select__value-container--has-value ss-flex-wrap-center">								<div class="react-select__single-value">{{ sorting.current.label }}</div>							</div>							<div class="react-select__indicators ss-flex-nowrap-center">								<div aria-hidden="true" class="react-select__indicator react-select__dropdown-indicator ss-flex-nowrap-center">									<svg height="20" width="20" viewBox="0 0 20 20" aria-hidden="true" focusable="false"><path d="M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"></path></svg>								</div>							</div>						</div>						<div ng-if="utilities.dropdown.open == sorting.current.label" class="react-select__menu">							<div class="react-select__menu-list">								<div ng-repeat="option in sorting.options" id="react-select-2-option-{{ $index }}" class="react-select__option ss-pointer" ng-class="{\'react-select__option--is-selected\': option.active}" ng-click="option.go()" tabindex="-1">{{ option.label }}</div>							</div>						</div>					</div>				</div>				<div class="product-listing-pane__facet-visibility-toggle-action" ng-click="specialized.sideToggle()">					<label>{{ specialized.lang.summary.filters }}</label>					<span class="ss-svg-icon">						<svg id="burger-with-animation" x="0" y="0" viewBox="0 0 100 100" xml:space="preserve">							<rect x="13" y="23.3" width="74" height="5.4"></rect>							<rect x="13" y="47.3" width="74" height="5.4"></rect>							<rect x="13" y="71.3" width="74" height="5.4"></rect>							<path id="burger-with-animation__black-circle1" d="M 68.3 16 c -5.5 0 -10 4.5 -10 10 s 4.5 10 10 10 s 10 -4.5 10 -10 s -4.5 -10 -10 -10 Z m 0 14.7 c -2.6 0 -4.7 -2.1 -4.7 -4.7 s 2.1 -4.7 4.7 -4.7 s 4.7 2.1 4.7 4.7 s -2.1 4.7 -4.7 4.7 Z"></path>							<circle id="burger-with-animation__white-circle1" class="prefix__st0" cx="68.3" cy="26" r="5"></circle>							<path id="burger-with-animation__black-circle2" d="M 43.2 40 c -5.5 0 -10 4.5 -10 10 s 4.5 10 10 10 s 10 -4.5 10 -10 s -4.5 -10 -10 -10 Z m 0 14.7 c -2.6 0 -4.7 -2.1 -4.7 -4.7 s 2.1 -4.7 4.7 -4.7 s 4.7 2.1 4.7 4.7 s -2.1 4.7 -4.7 4.7 Z"></path>							<circle id="burger-with-animation__white-circle2" class="prefix__st0" cx="43.2" cy="50" r="4.7"></circle>							<g>								<path id="burger-with-animation__black-circle3" d="M 68.3 64 c -5.5 0 -10 4.5 -10 10 s 4.5 10 10 10 s 10 -4.5 10 -10 s -4.5 -10 -10 -10 Z m 0 14.7 c -2.6 0 -4.7 -2.1 -4.7 -4.7 s 2.1 -4.7 4.7 -4.7 s 4.7 2.1 4.7 4.7 s -2.1 4.7 -4.7 4.7 Z"></path>								<circle id="burger-with-animation__white-circle3" class="prefix__st0" cx="68.3" cy="74" r="4.7"></circle>							</g>							<animate xlink:href="#burger-with-animation__white-circle1" attributeName="cx" from="{{ specialized.sidebar ? \'43.2\' : \'68.3\' }}" to="{{ specialized.sidebar ? \'68.3\' : \'43.2\' }}" dur="0.2s" begin="indefinite" fill="freeze" d="circ-anim"></animate>							<animate xlink:href="#burger-with-animation__white-circle2" attributeName="cx" from="{{ specialized.sidebar ? \'68.3\' : \'43.2\' }}" to="{{ specialized.sidebar ? \'43.2\' : \'68.3\' }}" dur="0.2s" begin="indefinite" fill="freeze" d="circ-anim"></animate>							<animate xlink:href="#burger-with-animation__white-circle3" attributeName="cx" from="{{ specialized.sidebar ? \'43.2\' : \'68.3\' }}" to="{{ specialized.sidebar ? \'68.3\' : \'43.2\' }}" dur="0.2s" begin="indefinite" fill="freeze" d="circ-anim"></animate>							<animate xlink:href="#burger-with-animation__black-circle1" attributeName="d" from="M{{ specialized.sidebar ? \'43.2\' : \'68.3\' }},16c-5.5 0-10 4.5-10 10s4.5 10 10 10 10-4.5 10-10-4.5-10-10-10zm0 14.7c-2.6 0-4.7-2.1-4.7-4.7s2.1-4.7 4.7-4.7 4.7 2.1 4.7 4.7-2.1 4.7-4.7 4.7z" to="M{{ specialized.sidebar ? \'68.3\' : \'43.2\' }},16c-5.5 0-10 4.5-10 10s4.5 10 10 10 10-4.5 10-10-4.5-10-10-10zm0 14.7c-2.6 0-4.7-2.1-4.7-4.7s2.1-4.7 4.7-4.7 4.7 2.1 4.7 4.7-2.1 4.7-4.7 4.7z" dur="0.2s" begin="indefinite" fill="freeze" d="M68.3,16c-5.5 0-10 4.5-10 10s4.5 10 10 10 10-4.5 10-10-4.5-10-10-10zm0 14.7c-2.6 0-4.7-2.1-4.7-4.7s2.1-4.7 4.7-4.7 4.7 2.1 4.7 4.7-2.1 4.7-4.7 4.7z"></animate>							<animate xlink:href="#burger-with-animation__black-circle2" attributeName="d" from="M{{ specialized.sidebar ? \'68.3\' : \'43.2\' }},40c-5.5 0-10 4.5-10 10s4.5 10 10 10 10-4.5 10-10-4.5-10-10-10zm0 14.7c-2.6 0-4.7-2.1-4.7-4.7s2.1-4.7 4.7-4.7 4.7 2.1 4.7 4.7-2.1 4.7-4.7 4.7z" to="M{{ specialized.sidebar ? \'43.2\' : \'68.3\' }},40c-5.5 0-10 4.5-10 10s4.5 10 10 10 10-4.5 10-10-4.5-10-10-10zm0 14.7c-2.6 0-4.7-2.1-4.7-4.7s2.1-4.7 4.7-4.7 4.7 2.1 4.7 4.7-2.1 4.7-4.7 4.7z" dur="0.2s" begin="indefinite" fill="freeze" d="M43.2,40c-5.5 0-10 4.5-10 10s4.5 10 10 10 10-4.5 10-10-4.5-10-10-10zm0 14.7c-2.6 0-4.7-2.1-4.7-4.7s2.1-4.7 4.7-4.7 4.7 2.1 4.7 4.7-2.1 4.7-4.7 4.7z"></animate>							<animate xlink:href="#burger-with-animation__black-circle3" attributeName="d" from="M{{ specialized.sidebar ? \'43.2\' : \'68.3\' }},64c-5.5 0-10 4.5-10 10s4.5 10 10 10 10-4.5 10-10-4.5-10-10-10zm0 14.7c-2.6 0-4.7-2.1-4.7-4.7s2.1-4.7 4.7-4.7 4.7 2.1 4.7 4.7-2.1 4.7-4.7 4.7z" to="M{{ specialized.sidebar ? \'68.3\' : \'43.2\' }},64c-5.5 0-10 4.5-10 10s4.5 10 10 10 10-4.5 10-10-4.5-10-10-10zm0 14.7c-2.6 0-4.7-2.1-4.7-4.7s2.1-4.7 4.7-4.7 4.7 2.1 4.7 4.7-2.1 4.7-4.7 4.7z" dur="0.2s" begin="indefinite" fill="freeze" d="M68.3,64c-5.5 0-10 4.5-10 10s4.5 10 10 10 10-4.5 10-10-4.5-10-10-10zm0 14.7c-2.6 0-4.7-2.1-4.7-4.7s2.1-4.7 4.7-4.7 4.7 2.1 4.7 4.7-2.1 4.7-4.7 4.7z"></animate>						</svg>					</span>				</div>			</div>		</div>		<div class="product-listing-pane__content">			<div id="searchspring-sidebar" class="product-listing-pane__facets" ng-class="{\'product-listing-pane__facets--closed\': !specialized.sidebar}"></div>			<div class="product-listing-pane__results product-listing-pane__results--3-column" ng-class="{\'product-listing-pane__results--expanded\': !specialized.sidebar}">				<div ng-if="merchandising.content.banner.length > 0" id="ss-merch-banner" class="ss-merchandising" ss-merchandising="banner"></div>				<div class="loadingOverlay loadingOverlay--top" id="listingOverlay" ng-style="{\'display\': loading || infinite.loading ? \'block\' : \'none\'}">					<div class="lds-ring">						<div></div><div></div><div></div><div></div>					</div>				</div>				<ul class="ss-item-container"></ul>				<div class="product-list__utility-nav">					<div class="pagination-bar bottom">						<div class="pages">							<ul ng-if="pagination.totalPages > 1" class="pagination">								<li class="icon-link prev" ng-class="{\'disabled\': pagination.noPrevious}">									<a href="{{ pagination.previous.url }}" tabindex="0" role="button" aria-disabled="{{ pagination.noPrevious }}" aria-label="Previous page">										<i class="icon-angle-left"></i>									</a>								</li>								<li ng-if="pagination.totalPages > 3 && pagination.currentPage > 2">									<a href="{{ pagination.first.url }}" role="button" tabindex="0" aria-label="{{ pagination.first.number }}">{{ pagination.first.number }}</a>								</li>								<li ng-if="pagination.totalPages > 3 && pagination.currentPage > 3" class="break">									<a ng-click="location().remove(\'page\').add(\'page\', (pagination.currentPage - 2)).go()" class="ss-pointer" role="button" tabindex="0">&hellip;</a>								</li>								<li ng-repeat="page in pagination.getPages(3)" ng-class="{\'active\': page.active}">									<a ng-if="page.active" role="button" tabindex="0" aria-label="Page {{ page.number }} is your current page" aria-current="page">{{ page.number }}</a>									<a ng-if="!page.active" href="{{ page.url }}" role="button" tabindex="0" aria-label="Page {{ page.number }}">{{ page.number }}</a>								</li>								<li ng-if="pagination.totalPages > 3 && pagination.currentPage < (pagination.totalPages - 2)" class="break">									<a ng-click="location().remove(\'page\').add(\'page\', (pagination.currentPage + 2)).go()" class="ss-pointer" role="button" tabindex="0">&hellip;</a>								</li>								<li ng-if="pagination.totalPages > 3 && pagination.currentPage < (pagination.totalPages - 1)">									<a href="{{ pagination.last.url }}" role="button" tabindex="0" aria-label="{{ pagination.last.number }}">{{ pagination.last.number }}</a>								</li>								<li class="icon-link next" ng-class="{\'disabled\': pagination.noNext}">									<a href="{{ pagination.next.url }}" tabindex="0" role="button" aria-disabled="{{ pagination.noNext }}" aria-label="Next page">										<i class="icon-angle-right"></i>									</a>								</li>							</ul>							<a ng-if="specialized.view && specialized.view == \'all\'" href="{{ location().remove(\'perpage\').add(\'perpage\', 500).url() }}" class="show-all">								{{ specialized.lang.pagination.all }} <span class="totalProductResult"></span>							</a>							<a ng-if="specialized.view && specialized.view == \'less\'" href="{{ location().remove(\'perpage\').url() }}" class="show-all">								{{ specialized.lang.pagination.paginate }} <span class="totalProductResult"></span>							</a>							<a ng-if="!specialized.view" class="show-all">								{{ specialized.lang.pagination.total }} <span class="totalProductResult"></span>							</a>						</div>					</div>				</div>			</div>						<div ng-if="merchandising.content.footer.length > 0" id="ss-merch-footer" class="ss-merchandising" ss-merchandising="footer"></div>			<div class="product-listing-pane__facets-mobile-actions" ng-class="{\'product-listing-pane__facets-mobile-actions--closed\': !specialized.sidebar}">				<a href="{{ location().remove(\'filter\').remove(\'rq\').url() }}"><div class="facet-mobile-actions__clear">{{ specialized.lang.facets.clear }}</div></a>				<a ng-click="specialized.sideToggle()" class="ss-pointer"><div class="facet-mobile-actions__apply">{{ specialized.lang.facets.apply }}</div></a>			</div>		</div>	</div>	<div ng-if="pagination.totalResults === 0" class="ss-no-results"></div></script><!-- Product Count --><script type="text/ss-template" name="Results - Items" target=".ss-results .totalProductResult">	({{ pagination.totalResults }})</script><!-- Results - Items --><script type="text/ss-template" name="Results - Items" target=".ss-results .ss-item-container">	<li ng-repeat="result in results track by result.uid" class="product-list__item">	<div ng-if="result.isInlineBanner" class="ss-inline-banner" ng-bind-html="result.content | trusted"></div>		<div ng-if="!result.isInlineBanner" class="product-list__item-wrapper" data-product-ic=\'{{ result.ss_product_data }}\'>			<div ng-if="result.selectedVariant.id" class="product-list__item-compare-checkbox-container" ng-class="{\'full\': !specialized.showCompare && !result.compare.active, \'cannot-compare\': result.compare.cannot}" ng-click="triggerCompare(result, $event)" ng-bind-html="result.compare.html | trusted"></div>						<div ng-if="result.selectedVariant.badges.center" class="ss-badges-center">				<div ng-repeat="badge in result.selectedVariant.badges.center" class="ss-badge" aria-label="ss-badge-pos-{{ badge.position }}">					<!-- <img ng-src="{{ badge.img }}" /> -->					<span>{{ badge.text }}</span>				</div>							</div>						<div ng-if="result.selectedVariant.badges.right" class="ss-badges-right">				<div ng-repeat="badge in result.selectedVariant.badges.right" class="ss-badge" ng-class="{ \'ss-badge-lower\': badge.position == 2 }" aria-label="ss-badge-pos-{{ badge.position }}">					<!-- <img ng-src="{{ badge.img }}" /> -->					<span>{{ badge.text }}</span>				</div>							</div>			<a itemprop="url" href="{{ result.url }}" intellisuggest title="{{ result.name }}" class="product-image product-list__image">				<div class="main-product-list-image lazy" role="img" aria-label="{{ result.name }}" ss-lazy-src="result.thumbnailImageUrl"></div>			</a>			<div class="product-list__content">				<ul ng-if="result.ss_swatches" class="product-list__swatches product__swatches">					<li ng-repeat="variant in result.ss_swatches | limitTo:7" ng-class="{\'active\': variant.color == result.selectedVariant.color, \'double\': variant.hex.length > 1}" ng-mouseover="(specialized.mobile || specialized.touch) ? false : swapVariants(result, variant)" ng-click="(specialized.mobile || specialized.touch) ? swapVariants(result, variant) : goToUrl(result.url)" intellisuggest tabindex="0">						<span ng-repeat="color in variant.hex" ng-style="{\'background-color\': color}"></span>					</li>					<li ng-if="result.ss_swatches.length > 7" class="product-list__swatches-expand-icon" tabindex="0" ng-click="goToUrl(result.url)" intellisuggest>						<span>							<div>								<span class="plus-icon svg-icon">									<svg viewBox="0 0 32 32"><polyline points="18.3,0 18.3,11.4 18.3,13.7 20.6,13.7 32,13.7 32,18.3 20.6,18.3 18.3,18.3 18.3,20.6 18.3,32 13.7,32 13.7,20.6 13.7,18.3 11.4,18.3 0,18.3 0,13.7 11.4,13.7 13.7,13.7 13.7,11.4 13.7,0 18.3,0"></polyline></svg>								</span>								<span class="product-list__swatches-expand-icon-count">{{ result.ss_swatches.length - 7 }}</span>							</div>						</span>					</li>				</ul>				<div class="product-list__content-text">					<div class="product-list__content-left">						<a class="product-list__name" href="{{ result.url }}" intellisuggest>{{ result.name | truncate:85:\'&hellip;\' }}</a>					</div>					<div ng-if="result.hasPrice">						<div class="product-list__item-price">							<div>								{{ ((result.price | currency : specialized.region.prefix : specialized.region.decimal : specialized.region.thousand : specialized.region.cent) | split : specialized.region.split)[0] }}{{ specialized.region.suffix }}							</div>							<div ng-if="result.hasSale" class="old">								{{ ((result.msrp | currency : specialized.region.prefix : specialized.region.decimal : specialized.region.thousand : specialized.region.cent) | split : specialized.region.split)[0] }}{{ specialized.region.suffix }}							</div>						</div>					</div>					<div class="ss-available-text ss-available-online" ng-if="((context.region == \'gb\' && specialized.region.siteId == \'uyx5rv\') || (specialized.region.location == \'Deutschland\' && specialized.region.lang == \'en\')) && result.available_qty * 1 > 0">In Stock</div>					<div class="ss-available-text ss-available-online" ng-if="specialized.region.location ==\'Deutschland\' && specialized.region.lang == \'de\' && result.available_qty * 1 > 0">Auf Lager</div>					<div class="ss-available-text" ng-if="context.region == \'gb\' && specialized.region.siteId == \'uyx5rv\' && result.available_qty * 1 > 0 && result.is_cnc.toLowerCase() == \'false\'">Online Only</div>					<div class="ss-available-text ss-specialized-delivery" ng-if="context.region == \'gb\' && specialized.region.siteId == \'uyx5rv\' && result.available_qty * 1 > 0 && result.available_for_home_delivery.toLowerCase() == \'true\'">Specialized Delivery Available</div>				</div>			</div>		</div>	</li></script><!-- No Results --><script type="text/ss-template" name="No Results" target=".ss-no-results">	<div class="ss-no-results-container">		<h3 class="ss-title">{{ specialized.lang.noResults.query(q) }}</h3>		<p ng-if="didYouMean.query.length" class="ss-did-you-mean" ng-bind-html="specialized.lang.noResults.query(didYouMean.query, location().remove(context.search).add(context.search, didYouMean.query).url()) | trusted"></p>		<h4 class="ss-title">{{ specialized.lang.noResults.suggest }}</h4>		<ul class="ss-suggestion-list">			<li>{{ specialized.lang.noResults.suggest1 }}</li>			<li>{{ specialized.lang.noResults.suggest2 }}</li>			<li>{{ specialized.lang.noResults.suggest3 }}</li>		</ul>		<div ng-if="specialized.region.contact" class="ss-contact ss-location">			<h4 class="ss-title">{{ specialized.lang.noResults.address }}</h4>			<p ng-bind-html="specialized.region.contact | trusted"></p>		</div>	</div></script><style name="badge styling">	.ss-item-container .ss-badge {		width: auto;		/* height: 24px; */		padding: 8px;		border-radius: 4px;		line-height: 1;		/*align-self: center;*/	}		.ss-item-container .ss-badge span {		font-family: \'DIN W01 Medium\';		font-size: 13.333px;	}		.ss-item-container .ss-badges-right {		display: flex;		flex-direction: column;		justify-content: center;		align-items: flex-end;		position: absolute;		top: 0;		right: 0;		padding: 24px;	}		.ss-item-container .ss-badges-right .ss-badge {		background-color: #252525;	}		.ss-item-container .ss-badges-right .ss-badge span {		color: #FFF;	}		.ss-item-container .ss-badges-right .ss-badge-lower {		background-color: #FFF;	}		.ss-item-container .ss-badges-right .ss-badge-lower span {		color: #252525;	}		.ss-item-container .ss-badge-lower {		display: none;		padding: 8px 0;	}		.ss-item-container .ss-badges-center {		display: none;		position: absolute;		top: 50%;		left: 50%;		margin-top: -60px;		margin-left: -40px;		z-index: 1;	}		.ss-item-container .ss-badges-center .ss-badge {		background-color: #F1F1F1;	}		.product-list__item:hover .ss-badges-center, .product-list__item:hover .ss-badge-lower {		display: block;	}</style>');
